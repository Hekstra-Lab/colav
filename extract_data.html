<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>extract_data module &mdash; colav 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=d45e8c67"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="colav quickstart guide" href="quickstart.html" />
    <link rel="prev" title="Welcome to colav’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            colav
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">extract_data</span></code> module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#colav.extract_data.calculate_coverage_matching_scores"><code class="docutils literal notranslate"><span class="pre">calculate_coverage_matching_scores()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#colav.extract_data.calculate_dh_pw"><code class="docutils literal notranslate"><span class="pre">calculate_dh_pw()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#colav.extract_data.calculate_dh_rc"><code class="docutils literal notranslate"><span class="pre">calculate_dh_rc()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#colav.extract_data.calculate_dh_sa"><code class="docutils literal notranslate"><span class="pre">calculate_dh_sa()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#colav.extract_data.calculate_pw_rc"><code class="docutils literal notranslate"><span class="pre">calculate_pw_rc()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#colav.extract_data.calculate_pw_sa"><code class="docutils literal notranslate"><span class="pre">calculate_pw_sa()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#colav.extract_data.calculate_sa_rc"><code class="docutils literal notranslate"><span class="pre">calculate_sa_rc()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#colav.extract_data.generate_dihedral_matrix"><code class="docutils literal notranslate"><span class="pre">generate_dihedral_matrix()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#colav.extract_data.generate_pw_matrix"><code class="docutils literal notranslate"><span class="pre">generate_pw_matrix()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#colav.extract_data.generate_strain_matrix"><code class="docutils literal notranslate"><span class="pre">generate_strain_matrix()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#colav.extract_data.load_dihedral_matrix"><code class="docutils literal notranslate"><span class="pre">load_dihedral_matrix()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#colav.extract_data.load_pw_matrix"><code class="docutils literal notranslate"><span class="pre">load_pw_matrix()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#colav.extract_data.load_strain_matrix"><code class="docutils literal notranslate"><span class="pre">load_strain_matrix()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html"><code class="docutils literal notranslate"><span class="pre">colav</span></code> quickstart guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="example.html">Example Usage</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">colav</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><code class="docutils literal notranslate"><span class="pre">extract_data</span></code> module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/extract_data.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-colav.extract_data">
<span id="extract-data-module"></span><h1><code class="docutils literal notranslate"><span class="pre">extract_data</span></code> module<a class="headerlink" href="#module-colav.extract_data" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="colav.extract_data.calculate_coverage_matching_scores">
<span class="sig-prename descclassname"><span class="pre">colav.extract_data.</span></span><span class="sig-name descname"><span class="pre">calculate_coverage_matching_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference_strucs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_strucs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resnum_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmsd_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simultaneous</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#colav.extract_data.calculate_coverage_matching_scores" title="Link to this definition"></a></dt>
<dd><p>Calculates the coverage and matching metrics for a sample set of structures/conformational ensemble compared to a reference set of structures/conformational ensemble.</p>
<p>The coverage and matching metrics used are defined by Xu et al. (2021) ICLR. The coverage metric measures the diversity of the sample set compared to the reference set. The matching metric measures the similarity of the sample set to the reference set.</p>
<section id="parameters">
<h2>Parameters:<a class="headerlink" href="#parameters" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>reference_strucs<span class="classifier">list of str</span></dt><dd><p>Array containing the file paths to reference structures.</p>
</dd>
<dt>sample_strucs<span class="classifier">list of str</span></dt><dd><p>Array containing the file paths to sample/generated structures.</p>
</dd>
<dt>resnum_bounds<span class="classifier">tuple</span></dt><dd><p>Tuple containing the minimum and maximum (inclusive) residue number values.</p>
</dd>
<dt>rmsd_threshold<span class="classifier">float</span></dt><dd><p>Minimum value for two structures to be considered similar.</p>
</dd>
<dt>simultaneous<span class="classifier">bool</span></dt><dd><p>Indicator for simultaneous calculation of RMSD; otherwise, calculations are sequential.</p>
</dd>
<dt>verbose<span class="classifier">bool</span></dt><dd><p>Indicator for verbose output.</p>
</dd>
</dl>
</section>
<section id="returns">
<h2>Returns:<a class="headerlink" href="#returns" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>coverage<span class="classifier">float</span></dt><dd><p>Coverage score that compares the diversity of the supplied conformational ensembles.</p>
</dd>
<dt>matching<span class="classifier">float</span></dt><dd><p>Matching score that compares the similarity of the supplied conformational ensembles.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="colav.extract_data.calculate_dh_pw">
<span class="sig-prename descclassname"><span class="pre">colav.extract_data.</span></span><span class="sig-name descname"><span class="pre">calculate_dh_pw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_pca</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pw_pca</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resnum_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omg_idx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#colav.extract_data.calculate_dh_pw" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="colav.extract_data.calculate_dh_rc">
<span class="sig-prename descclassname"><span class="pre">colav.extract_data.</span></span><span class="sig-name descname"><span class="pre">calculate_dh_rc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raw_dh_loading</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadrature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#colav.extract_data.calculate_dh_rc" title="Link to this definition"></a></dt>
<dd><p>Adjusts raw dihedral loading for interpretability.</p>
<p>Calculates a residue contribution from a raw loading of dihedral angle features to account
for the application of sine and cosine functions.</p>
<p>Returns a residue contribution.</p>
<section id="id1">
<h2>Parameters:<a class="headerlink" href="#id1" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>raw_dh_loading<span class="classifier">array_like, (N,)</span></dt><dd><p>Array of raw loading from PCA.</p>
</dd>
<dt>quadrature<span class="classifier">bool, optional</span></dt><dd><p>Indicator to calculate residue contributions in quadrature.</p>
</dd>
</dl>
</section>
<section id="id2">
<h2>Returns:<a class="headerlink" href="#id2" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>tranformed_dh_loading<span class="classifier">array_like, (N/2,)</span></dt><dd><p>Array of residue contribution to determine relative angle influence in the given
loading.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="colav.extract_data.calculate_dh_sa">
<span class="sig-prename descclassname"><span class="pre">colav.extract_data.</span></span><span class="sig-name descname"><span class="pre">calculate_dh_sa</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_pca</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sa_pca</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shared_atom_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omg_idx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#colav.extract_data.calculate_dh_sa" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="colav.extract_data.calculate_pw_rc">
<span class="sig-prename descclassname"><span class="pre">colav.extract_data.</span></span><span class="sig-name descname"><span class="pre">calculate_pw_rc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raw_pw_loading</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resnum_bounds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#colav.extract_data.calculate_pw_rc" title="Link to this definition"></a></dt>
<dd><p>Adjusts raw pairwise distance loading for interpretability.</p>
<p>Calculates a residue contribution from a raw loading of pairwise distance features to account
for all pairings of residues.</p>
<p>Returns a residue contribution.</p>
<section id="id3">
<h2>Parameters:<a class="headerlink" href="#id3" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>raw_pw_loading<span class="classifier">array_like, (N,)</span></dt><dd><p>Array of raw loading from PCA.</p>
</dd>
<dt>resnum_bounds<span class="classifier">tuple</span></dt><dd><p>Tuple containing the minimum and maximum (inclusive) residue number values.</p>
</dd>
</dl>
</section>
<section id="id4">
<h2>Returns:<a class="headerlink" href="#id4" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>tranformed_pw_loading<span class="classifier">array_like, (N/2,)</span></dt><dd><p>Array of residue contribution to determine relative residue influence in the given loading.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="colav.extract_data.calculate_pw_sa">
<span class="sig-prename descclassname"><span class="pre">colav.extract_data.</span></span><span class="sig-name descname"><span class="pre">calculate_pw_sa</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pw_pca</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sa_pca</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resnum_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shared_atom_set</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#colav.extract_data.calculate_pw_sa" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="colav.extract_data.calculate_sa_rc">
<span class="sig-prename descclassname"><span class="pre">colav.extract_data.</span></span><span class="sig-name descname"><span class="pre">calculate_sa_rc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raw_sa_loading</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shared_atom_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#colav.extract_data.calculate_sa_rc" title="Link to this definition"></a></dt>
<dd><p>Adjusts raw strain or shear loading for interpretability.</p>
<p>Calculates a residue contribution from a raw loading of strain or shear tensor features.</p>
<p>Returns a residue contribution.</p>
<section id="id5">
<h2>Parameters:<a class="headerlink" href="#id5" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>raw_sa_loading<span class="classifier">array_like</span></dt><dd><p>Array of raw loading from PCA.</p>
</dd>
<dt>shared_atom_list<span class="classifier">array_like</span></dt><dd><p>Sorted list of shared atoms between all structures used for strain analysis.</p>
</dd>
</dl>
</section>
<section id="id6">
<h2>Returns:<a class="headerlink" href="#id6" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>tranformed_sa_loading<span class="classifier">array_like</span></dt><dd><p>Array of residue contribution to determine relative residue influence in the given loading.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="colav.extract_data.generate_dihedral_matrix">
<span class="sig-prename descclassname"><span class="pre">colav.extract_data.</span></span><span class="sig-name descname"><span class="pre">generate_dihedral_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resnum_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_psi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_phi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#colav.extract_data.generate_dihedral_matrix" title="Link to this definition"></a></dt>
<dd><p>Extracts dihedrals angles from given structures.</p>
<p>Extracts and returns a data matrix of (observations x features) with the given structures as observations
and the linearized dihedral angles (by applying sine and cosine functions) as features.
Cannot handle missing coordinates and skips structures with missing backbone atoms within the
given residue numbers.</p>
<section id="id7">
<h2>Parameters:<a class="headerlink" href="#id7" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>structure_list<span class="classifier">list of str</span></dt><dd><p>Array containing the file paths to PDB structures.</p>
</dd>
<dt>resnum_bounds<span class="classifier">tuple</span></dt><dd><p>Tuple containing the minimum and maximum (inclusive) residue number values.</p>
</dd>
<dt>no_psi<span class="classifier">bool, optional</span></dt><dd><p>Indicator to exclude psi dihedral angle from returned dihedral angles.</p>
</dd>
<dt>no_omega<span class="classifier">bool, optional</span></dt><dd><p>Indicator to exclude omega dihedral angle from returned dihedral angles.</p>
</dd>
<dt>no_phi<span class="classifier">bool, optional</span></dt><dd><p>Indicator to exclude phi dihedral angle from returned dihedral angles.</p>
</dd>
<dt>save<span class="classifier">bool, optional</span></dt><dd><p>Indicator to save results.</p>
</dd>
<dt>save_prefix<span class="classifier">str</span></dt><dd><p>If saving results, prefix for pickle save file.</p>
</dd>
<dt>verbose<span class="classifier">bool, optional</span></dt><dd><p>Indicator for verbose output.</p>
</dd>
</dl>
</section>
<section id="id8">
<h2>Returns:<a class="headerlink" href="#id8" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>dh_data_matrix<span class="classifier">array_like</span></dt><dd><p>Array containing dihedral angles within <cite>resnum_bounds</cite> for structures in <cite>structure_list</cite>,
excluding structures missing desired atoms.</p>
</dd>
<dt>dh_strucs<span class="classifier">list of str</span></dt><dd><p>List of structures ordered as stored in <cite>dh_data_matrix</cite>.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="colav.extract_data.generate_pw_matrix">
<span class="sig-prename descclassname"><span class="pre">colav.extract_data.</span></span><span class="sig-name descname"><span class="pre">generate_pw_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resnum_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#colav.extract_data.generate_pw_matrix" title="Link to this definition"></a></dt>
<dd><p>Extracts pairwise distances from given structures.</p>
<p>Extracts and returns a data matrix of (observations x features) with the given structures as observations
and the pairwise distances between alpha carbon (CA) atoms as features. Cannot handle missing
coordinates and skips structures with missing CA atoms within the given residue numbers.</p>
<section id="id9">
<h2>Parameters:<a class="headerlink" href="#id9" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>structure_list<span class="classifier">list of str</span></dt><dd><p>Array containing the file paths to PDB structures.</p>
</dd>
<dt>resnum_bounds<span class="classifier">tuple</span></dt><dd><p>Tuple containing the minimum and maximum (inclusive) residue number values.</p>
</dd>
<dt>save<span class="classifier">bool, optional</span></dt><dd><p>Indicator to save results.</p>
</dd>
<dt>save_prefix<span class="classifier">str</span></dt><dd><p>If saving results, prefix for pickle save file.</p>
</dd>
<dt>verbose<span class="classifier">bool, optional</span></dt><dd><p>Indicator for verbose output.</p>
</dd>
</dl>
</section>
<section id="id10">
<h2>Returns:<a class="headerlink" href="#id10" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>pw_data_matrix<span class="classifier">array_like</span></dt><dd><p>array containing pairwise distances between desired CA atoms for structures
in <cite>structure_list</cite>, excluding structures missing desired atoms.</p>
</dd>
<dt>pw_strucs<span class="classifier">list of str</span></dt><dd><p>List of structures ordered as stored in <cite>pw_data_matrix</cite>.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="colav.extract_data.generate_strain_matrix">
<span class="sig-prename descclassname"><span class="pre">colav.extract_data.</span></span><span class="sig-name descname"><span class="pre">generate_strain_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_pdb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resnum_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['N',</span> <span class="pre">'C',</span> <span class="pre">'CA',</span> <span class="pre">'CB',</span> <span class="pre">'O']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alt_locs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['',</span> <span class="pre">'A']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_additional</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#colav.extract_data.generate_strain_matrix" title="Link to this definition"></a></dt>
<dd><p>Extracts strain tensors, shear tensors, or shear energies from given structures.</p>
<p>Extracts and returns a data matrix of (observations x features) with the given structures as observations
and strain tensors, shear tensors, or shear energies. For tensor features, only the off-diagonal
elements are included. Cannot handle missing coordinates and skips structures with missing
backbone atoms within the given residue numbers.</p>
<section id="id11">
<h2>Parameters:<a class="headerlink" href="#id11" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>structure_list<span class="classifier">list of str</span></dt><dd><p>Array containing the file paths to PDB structures.</p>
</dd>
<dt>reference_pdb<span class="classifier">str</span></dt><dd><p>File path to the reference PDB structure; this structure can be contained in <cite>structure_list</cite>.</p>
</dd>
<dt>data_type<span class="classifier">{‘straint’, ‘sheart’, ‘sheare’}</span></dt><dd><p>Indicator for type of data to build data matrix.</p>
</dd>
<dt>resnum_bounds<span class="classifier">tuple</span></dt><dd><p>Tuple containing the minimum and maximum (inclusive) residue number values.</p>
</dd>
<dt>atoms<span class="classifier">array_like, optional</span></dt><dd><p>Array containing atom names.</p>
</dd>
<dt>alt_locs<span class="classifier">array_like, optional</span></dt><dd><p>Array containing alternate location names.</p>
</dd>
<dt>save<span class="classifier">bool, optional</span></dt><dd><p>Indicator to save results.</p>
</dd>
<dt>save_prefix<span class="classifier">str</span></dt><dd><p>If saving results, prefix for pickle save file.</p>
</dd>
<dt>save_additional<span class="classifier">bool, optional</span></dt><dd><p>Indicator to save results of nested calculations.</p>
</dd>
<dt>verbose<span class="classifier">bool, optional</span></dt><dd><p>Indicator for verbose output.</p>
</dd>
</dl>
</section>
<section id="id12">
<h2>Returns:<a class="headerlink" href="#id12" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>sa_data_matrix<span class="classifier">array_like</span></dt><dd><p>Array containing strain or shear tensor information structures in <cite>structure_list</cite>,
excluding structures missing desired atoms.</p>
</dd>
<dt>sa_strucs<span class="classifier">list of str</span></dt><dd><p>List of structures ordered as stored in the <cite>sa_data_matrix</cite>.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="colav.extract_data.load_dihedral_matrix">
<span class="sig-prename descclassname"><span class="pre">colav.extract_data.</span></span><span class="sig-name descname"><span class="pre">load_dihedral_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dh_pkl</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#colav.extract_data.load_dihedral_matrix" title="Link to this definition"></a></dt>
<dd><p>Loads the dihedral data matrix and corresponding structures</p>
<p>Loads a dictionary containing the dihedral data matrix as <cite>data_matrix</cite> key
and the corresponding structures as <cite>structures</cite> key</p>
<section id="id13">
<h2>Parameters:<a class="headerlink" href="#id13" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>dh_pkl<span class="classifier">str</span></dt><dd><p>File path to the dihedral dictionary pickle file.</p>
</dd>
</dl>
</section>
<section id="id14">
<h2>Returns:<a class="headerlink" href="#id14" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>dh_data_matrix<span class="classifier">array_like</span></dt><dd><p>Array containing dihedral angles as calculated by <cite>generate_dihedral_matrix</cite>.</p>
</dd>
<dt>dh_strucs<span class="classifier">list of str</span></dt><dd><p>List of structures ordered as stored in <cite>dh_data_matrix</cite>.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="colav.extract_data.load_pw_matrix">
<span class="sig-prename descclassname"><span class="pre">colav.extract_data.</span></span><span class="sig-name descname"><span class="pre">load_pw_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pw_pkl</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#colav.extract_data.load_pw_matrix" title="Link to this definition"></a></dt>
<dd><p>Loads the pairwise distance data matrix and corresponding structures</p>
<p>Loads a dictionary containing the pairwise distance data matrix as <cite>data_matrix</cite> key
and the corresponding structures as <cite>structures</cite> key</p>
<section id="id15">
<h2>Parameters:<a class="headerlink" href="#id15" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>pw_pkl<span class="classifier">str</span></dt><dd><p>File path to the pairwise distance dictionary pickle file.</p>
</dd>
</dl>
</section>
<section id="id16">
<h2>Returns:<a class="headerlink" href="#id16" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>pw_data_matrix<span class="classifier">array_like</span></dt><dd><p>Array containing dihedral angles as calculated by <cite>generate_pw_matrix</cite>.</p>
</dd>
<dt>pw_strucs<span class="classifier">list of str</span></dt><dd><p>List of structures ordered as stored in <cite>pw_data_matrix</cite>.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="colav.extract_data.load_strain_matrix">
<span class="sig-prename descclassname"><span class="pre">colav.extract_data.</span></span><span class="sig-name descname"><span class="pre">load_strain_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strain_pkl</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#colav.extract_data.load_strain_matrix" title="Link to this definition"></a></dt>
<dd><p>Loads the strain data matrix and corresponding structures</p>
<p>Loads a dictionary containing the strain data matrix as <cite>data_matrix</cite> key
and the corresponding structures as <cite>structures</cite> key</p>
<section id="id17">
<h2>Parameters:<a class="headerlink" href="#id17" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>strain_pkl<span class="classifier">str</span></dt><dd><p>File path to the strain dictionary pickle file.</p>
</dd>
</dl>
</section>
<section id="id18">
<h2>Returns:<a class="headerlink" href="#id18" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>sa_data_matrix<span class="classifier">array_like</span></dt><dd><p>Array containing dihedral angles as calculated by <cite>generate_sa_matrix</cite>.</p>
</dd>
<dt>sa_strucs<span class="classifier">list of str</span></dt><dd><p>List of structures ordered as stored in <cite>sa_data_matrix</cite>.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to colav’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="quickstart.html" class="btn btn-neutral float-right" title="colav quickstart guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Ammaar Saeed.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>