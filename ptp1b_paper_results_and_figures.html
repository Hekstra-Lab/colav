<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Importing packages and data &mdash; colav 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/nbsphinx-code-cells.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=d45e8c67"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Example Usage" href="example.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            colav
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="extract_data.html"><code class="docutils literal notranslate"><span class="pre">extract_data</span></code> module</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html"><code class="docutils literal notranslate"><span class="pre">colav</span></code> quickstart guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="example.html">Example Usage</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Importing packages and data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Main-text-figures">Main text figures</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#PCA-of-COLAV-representations">PCA of COLAV representations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Dihedral-Angle-PCA-space-(PC1-&amp;-PC2)-with-RC1-&amp;-RC2">Dihedral Angle PCA space (PC1 &amp; PC2) with RC1 &amp; RC2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Contingency-table-and-chi-squared-test">Contingency table and chi-squared test</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Oxidized-conformation-of-PTP-1B">Oxidized conformation of PTP-1B</a></li>
<li class="toctree-l3"><a class="reference internal" href="#PCA-on-PDB-structures-only">PCA on PDB structures only</a></li>
<li class="toctree-l3"><a class="reference internal" href="#PCA-on-crystallographic-drug-fragment-screen-structures">PCA on crystallographic drug fragment screen structures</a></li>
<li class="toctree-l3"><a class="reference internal" href="#COV-and-MAT-score-calculations">COV and MAT score calculations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Conformational-changes-focusing-on-individual-PCs">Conformational changes focusing on individual PCs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Supplementary-Figures">Supplementary Figures</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">colav</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="example.html">Example Usage</a></li>
      <li class="breadcrumb-item active">Importing packages and data</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/ptp1b_paper_results_and_figures.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Importing-packages-and-data">
<h1>Importing packages and data<a class="headerlink" href="#Importing-packages-and-data" title="Link to this heading">ÔÉÅ</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">pearsonr</span><span class="p">,</span> <span class="n">chi2_contingency</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Rectangle</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="kn">import</span> <span class="n">make_axes_locatable</span>
<span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Pool</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">colav.extract_data</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">biopandas.pdb</span> <span class="kn">import</span> <span class="n">PandasPdb</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">sklearn.manifold</span> <span class="kn">import</span> <span class="n">TSNE</span>
<span class="kn">from</span> <span class="nn">umap</span> <span class="kn">import</span> <span class="n">UMAP</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/asaeed/miniforge3/envs/comp/lib/python3.9/site-packages/umap/distances.py:1063: NumbaDeprecationWarning: <span class="ansi-bold">The &#39;nopython&#39; keyword argument was not supplied to the &#39;numba.jit&#39; decorator. The implicit default value for this argument is currently False, but it will be changed to True in Numba 0.59.0. See https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit for details.</span>
  @numba.jit()
/Users/asaeed/miniforge3/envs/comp/lib/python3.9/site-packages/umap/distances.py:1071: NumbaDeprecationWarning: <span class="ansi-bold">The &#39;nopython&#39; keyword argument was not supplied to the &#39;numba.jit&#39; decorator. The implicit default value for this argument is currently False, but it will be changed to True in Numba 0.59.0. See https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit for details.</span>
  @numba.jit()
/Users/asaeed/miniforge3/envs/comp/lib/python3.9/site-packages/umap/distances.py:1086: NumbaDeprecationWarning: <span class="ansi-bold">The &#39;nopython&#39; keyword argument was not supplied to the &#39;numba.jit&#39; decorator. The implicit default value for this argument is currently False, but it will be changed to True in Numba 0.59.0. See https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit for details.</span>
  @numba.jit()
/Users/asaeed/miniforge3/envs/comp/lib/python3.9/site-packages/umap/umap_.py:660: NumbaDeprecationWarning: <span class="ansi-bold">The &#39;nopython&#39; keyword argument was not supplied to the &#39;numba.jit&#39; decorator. The implicit default value for this argument is currently False, but it will be changed to True in Numba 0.59.0. See https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit for details.</span>
  @numba.jit()
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sns.set_palette(sns.color_palette(&quot;Dark2&quot;))</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;font.size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;axes.labelsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;axes.labelweight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;regular&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;axes.titlesize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;axes.titleweight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;regular&quot;</span>
<span class="n">resnum_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">279</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">theseus_strucs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;ptp1b_data/ptp1b_theseus_data/*pdb&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># untreated dihedral data processing</span>
<span class="n">untreated_dihedrals</span><span class="p">,</span> <span class="n">dihedral_strucs</span> <span class="o">=</span> <span class="n">generate_dihedral_matrix</span><span class="p">(</span>
    <span class="n">theseus_strucs</span><span class="p">,</span>
    <span class="n">resnum_bounds</span><span class="p">,</span>
    <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">save_prefix</span><span class="o">=</span><span class="s2">&quot;ptp1b_data/ptp1b&quot;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># untreated_dihedrals, dihedral_strucs = load_dihedral_matrix(&#39;ptp1b_data/ptp1b_dh_dict.pkl&#39;)</span>
<span class="n">untreated_dihedrals_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
    <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">untreated_dihedrals</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">untreated_dihedrals</span><span class="p">)]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Calculating the dihedral angles...
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1a5y_chainA.pdb
Skipping ptp1b_data/ptp1b_theseus_data/theseus_1a5y_chainA.pdb; insufficient atoms!
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1aax_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1bzc_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1bzh_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1bzj_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1c83_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1c84_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1c85_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1c86_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1c87_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1c88_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1ecv_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1een_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1eeo_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1g1f_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1g1g_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1g1h_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1g7f_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1g7g_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1gfy_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1i57_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1jf7_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1jf7_chainB.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1kak_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1kav_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1l8g_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1lqf_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1lqf_chainB.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1lqf_chainC.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1lqf_chainD.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1nl9_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1nny_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1no6_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1nwe_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1nwl_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1nz7_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1oem_chainX.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1oeo_chainX.pdb
Skipping ptp1b_data/ptp1b_theseus_data/theseus_1oeo_chainX.pdb; insufficient atoms!
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1oes_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1oet_chainA.pdb
Skipping ptp1b_data/ptp1b_theseus_data/theseus_1oet_chainA.pdb; insufficient atoms!
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1oeu_chainA.pdb
Skipping ptp1b_data/ptp1b_theseus_data/theseus_1oeu_chainA.pdb; insufficient atoms!
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1oev_chainA.pdb
Skipping ptp1b_data/ptp1b_theseus_data/theseus_1oev_chainA.pdb; insufficient atoms!
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1ony_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1onz_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1pa1_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1ph0_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1ptt_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1ptu_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1ptv_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1pty_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1pxh_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1pyn_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1q1m_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1q6j_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1q6m_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1q6n_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1q6n_chainB.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1q6p_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1q6p_chainB.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1q6s_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1q6s_chainB.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1q6t_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1q6t_chainB.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1qxk_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1sug_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1t48_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1t49_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1t4j_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1wax_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_1xbo_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2azr_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2b07_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2b4s_chainA.pdb
Skipping ptp1b_data/ptp1b_theseus_data/theseus_2b4s_chainA.pdb; insufficient atoms!
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2b4s_chainC.pdb
Skipping ptp1b_data/ptp1b_theseus_data/theseus_2b4s_chainC.pdb; insufficient atoms!
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2bgd_chainA.pdb
Skipping ptp1b_data/ptp1b_theseus_data/theseus_2bgd_chainA.pdb; insufficient atoms!
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2bge_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2cm2_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2cm3_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2cm3_chainB.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2cm7_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2cm8_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2cma_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2cmb_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2cmc_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2cne_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2cnf_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2cng_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2cnh_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2cni_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2f6f_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2f6t_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2f6v_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2f6w_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2f6y_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2f6z_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2f70_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2f71_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2fjm_chainA.pdb
Skipping ptp1b_data/ptp1b_theseus_data/theseus_2fjm_chainA.pdb; insufficient atoms!
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2fjm_chainB.pdb
Skipping ptp1b_data/ptp1b_theseus_data/theseus_2fjm_chainB.pdb; insufficient atoms!
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2fjn_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2fjn_chainB.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2h4g_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2h4k_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2hb1_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2hnp_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2hnq_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2nt7_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2nta_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2qbp_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2qbq_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2qbr_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2qbs_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2veu_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2vev_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2vew_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2vex_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2vey_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2zmm_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_2zn7_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_3a5j_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_3a5k_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_3cwe_chainA.pdb
Skipping ptp1b_data/ptp1b_theseus_data/theseus_3cwe_chainA.pdb; insufficient atoms!
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_3d9c_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_3eax_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_3eb1_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_3eu0_chainA.pdb
Skipping ptp1b_data/ptp1b_theseus_data/theseus_3eu0_chainA.pdb; insufficient atoms!
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_3i7z_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_3i80_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_3qkp_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_3qkq_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_3sme_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_3zv2_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_4bjo_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_4bjo_chainB.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_4qah_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_4qap_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_4qbe_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_4qbw_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_4y14_chainA.pdb
Skipping ptp1b_data/ptp1b_theseus_data/theseus_4y14_chainA.pdb; insufficient atoms!
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_4y14_chainB.pdb
Skipping ptp1b_data/ptp1b_theseus_data/theseus_4y14_chainB.pdb; insufficient atoms!
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_5k9v_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_5k9w_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_5ka0_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_5ka1_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_5ka2_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_5ka3_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_5ka4_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_5ka7_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_5ka8_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_5ka9_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_5kaa_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_5kab_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_5kac_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_5kad_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_5kad_chainB.pdb
Skipping ptp1b_data/ptp1b_theseus_data/theseus_5kad_chainB.pdb; insufficient atoms!
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_5t19_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_6b8e_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_6b8t_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_6b8x_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_6b8z_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_6b90_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_6b95_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_6bai_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_6cwu_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_6cwv_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_6ntp_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_6ol4_chainA.pdb
Skipping ptp1b_data/ptp1b_theseus_data/theseus_6ol4_chainA.pdb; insufficient atoms!
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_6olq_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_6olv_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_6omy_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_6pfw_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_6pg0_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_6pgt_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_6pha_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_6phs_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_6pm8_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_7ken_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_7mm1_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0049_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0056_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0058_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0060_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0070_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0071_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0072_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0076_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0077_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0085_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0105_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0111_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0112_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0116_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0118_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0122_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0175_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0180_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0193_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0202_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0205_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0225_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0234_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0241_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0245_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0249_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0288_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0290_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0296_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0323_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0346_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0363_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0375_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0426_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0432_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0441_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0446_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0517_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0518_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0522_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0528_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0538_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0545_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0548_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0559_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0571_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0572_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0573_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0579_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0580_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0589_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0591_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0608_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0623_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0634_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0639_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0645_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0646_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0652_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0654_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0656_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0660_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0676_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0678_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0679_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0710_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0711_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0718_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0720_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0721_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0723_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0725_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0766_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0772_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0812_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0816_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0822_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0829_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0835_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0842_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0845_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0846_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0847_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0876_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0877_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0884_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0891_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0911_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0912_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0914_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0921_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0935_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0953_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0963_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0965_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0972_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0986_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y0994_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1009_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1011_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1043_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1060_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1103_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1125_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1136_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1153_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1163_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1182_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1207_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1242_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1257_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1261_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1264_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1265_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1271_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1288_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1294_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1298_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1302_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1304_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1312_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1314_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1316_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1317_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1318_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1319_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1320_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1327_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1335_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1339_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1343_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1373_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1402_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1417_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1429_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1438_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1442_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1461_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1486_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1492_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1499_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1525_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1527_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1530_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1532_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1548_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1554_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1589_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1594_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1608_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1612_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1613_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1618_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1629_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1646_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1652_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1703_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1710_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1711_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1718_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1733_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1734_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1759_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1763_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1781_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1787_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1791_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1804_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1819_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1827_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1839_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1841_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1842_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1860_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1865_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1868_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1875_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1885_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1886_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1888_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1902_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1904_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1922_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1933_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1938_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1943_chainA.pdb
Attempting to calculate for ptp1b_data/ptp1b_theseus_data/theseus_PTP1B-y1957_chainA.pdb
Saving dh_dict data!
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># rope dihedral data processing</span>
<span class="n">rope_dihedrals</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;ptp1b_data/filtered-ptp1b.csv&quot;</span><span class="p">)</span>
<span class="n">rope_strucs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rope_dihedrals</span><span class="o">.</span><span class="n">Name</span><span class="o">.</span><span class="n">values</span><span class="p">])</span>
<span class="n">rope_dihedrals</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;Unnamed: 0&quot;</span><span class="p">,</span> <span class="s2">&quot;Name&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">rope_dihedrals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">rope_dihedrals</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">rope_dihedrals_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">rope_dihedrals</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">rope_dihedrals</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dihedral PCA</span>
<span class="c1"># untreated</span>
<span class="n">u_pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">u_A</span> <span class="o">=</span> <span class="n">u_pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">untreated_dihedrals_data</span><span class="p">)</span>

<span class="c1"># rope</span>
<span class="n">rope_pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">rope_A</span> <span class="o">=</span> <span class="n">rope_pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">rope_dihedrals_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u_pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">,</span> <span class="n">rope_pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([0.29747788, 0.06309758, 0.037037  , 0.03535305, 0.0287802 ,
        0.02453796, 0.02153294, 0.01868356, 0.01458321, 0.01343809]),
 array([0.26460967, 0.05141095, 0.03610283, 0.03250671, 0.02652774,
        0.0217012 , 0.02028537, 0.01891694, 0.01596703, 0.01525418]))
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pairwise distances data processing</span>
<span class="c1"># pw_data, pw_strucs = generate_pw_matrix(theseus_strucs,</span>
<span class="c1">#                                         resnum_bounds,</span>
<span class="c1">#                                         save=True,</span>
<span class="c1">#                                         save_prefix=&#39;ptp1b_data/ptp1b&#39;,</span>
<span class="c1">#                                         verbose=False)</span>
<span class="n">pw_data</span><span class="p">,</span> <span class="n">pw_strucs</span> <span class="o">=</span> <span class="n">load_pw_matrix</span><span class="p">(</span><span class="s2">&quot;ptp1b_data/ptp1b_pw_dict.pkl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pairwise Distance PCA</span>
<span class="n">pw_pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">pw_A</span> <span class="o">=</span> <span class="n">pw_pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">pw_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pw_pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([0.59867585, 0.0718247 , 0.06767347, 0.04182721, 0.03015834,
       0.0148717 , 0.01308885, 0.01175772, 0.00932679, 0.00816632])
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># strain data processing</span>
<span class="c1"># sa_data, sa_strucs = generate_strain_matrix(</span>
<span class="c1">#     theseus_strucs,</span>
<span class="c1">#     &quot;ptp1b_data/ptp1b_theseus_data/theseus_1nwl_chainA.pdb&quot;,</span>
<span class="c1">#     &quot;sheart&quot;,</span>
<span class="c1">#     resnum_bounds,</span>
<span class="c1">#     save=True,</span>
<span class="c1">#     save_prefix=&quot;ptp1b_data/ptp1b_1nwl&quot;,</span>
<span class="c1">#     verbose=False,</span>
<span class="c1"># )</span>
<span class="n">sa_data</span><span class="p">,</span> <span class="n">sa_strucs</span> <span class="o">=</span> <span class="n">load_strain_matrix</span><span class="p">(</span><span class="s2">&quot;ptp1b_data/ptp1b_1nwl_sa_sheart_dict.pkl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># from colav.strain_analysis import determine_shared_atoms</span>
<span class="c1"># atom_set = determine_shared_atoms(</span>
<span class="c1">#     theseus_strucs,</span>
<span class="c1">#     PandasPdb().read_pdb(&quot;ptp1b_data/ptp1b_theseus_data/theseus_1nwl_chainA.pdb&quot;).df[&#39;ATOM&#39;],</span>
<span class="c1">#     resnum_bounds,</span>
<span class="c1">#     save=True,</span>
<span class="c1">#     save_prefix=&#39;ptp1b_data/ptp1b&#39;</span>
<span class="c1"># )</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Strain Analysis PCA</span>
<span class="n">sa_pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">sa_A</span> <span class="o">=</span> <span class="n">sa_pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">sa_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sa_pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([0.58555996, 0.08409118, 0.0470309 , 0.03535379, 0.02284818,
       0.0167237 , 0.01463643, 0.0122772 , 0.01073388, 0.00857248])
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conformation_dict</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;ptp1b_data/ptp1b_conformation_dict.pkl&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">space_group_dict</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;ptp1b_data/ptp1b_sg_dict.pkl&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># truncated to fit w/ resnum_bounds</span>
<span class="n">ptp1b_ss_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sa">u</span><span class="s2">&quot;</span><span class="se">\u03b1</span><span class="s2">1&#39;&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">13</span><span class="p">),</span>
    <span class="sa">u</span><span class="s2">&quot;</span><span class="se">\u03b1</span><span class="s2">2&#39;&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">25</span><span class="p">),</span>
    <span class="sa">u</span><span class="s1">&#39;</span><span class="se">\u03b1</span><span class="s1">1&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="mi">44</span><span class="p">),</span>
    <span class="sa">u</span><span class="s1">&#39;</span><span class="se">\u03b2</span><span class="s1">1&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">56</span><span class="p">,</span><span class="mi">59</span><span class="p">),</span>
    <span class="sa">u</span><span class="s1">&#39;</span><span class="se">\u03b2</span><span class="s1">2&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">69</span><span class="p">,</span><span class="mi">74</span><span class="p">),</span>
    <span class="sa">u</span><span class="s1">&#39;</span><span class="se">\u03b2</span><span class="s1">3&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">78</span><span class="p">,</span><span class="mi">84</span><span class="p">),</span>
    <span class="sa">u</span><span class="s1">&#39;</span><span class="se">\u03b1</span><span class="s1">2&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">91</span><span class="p">,</span><span class="mi">102</span><span class="p">),</span>
    <span class="sa">u</span><span class="s1">&#39;</span><span class="se">\u03b2</span><span class="s1">4&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">106</span><span class="p">,</span><span class="mi">109</span><span class="p">),</span>
    <span class="sa">u</span><span class="s1">&#39;</span><span class="se">\u03b2</span><span class="s1">5&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">114</span><span class="p">,</span><span class="mi">115</span><span class="p">),</span>
    <span class="sa">u</span><span class="s1">&#39;</span><span class="se">\u03b2</span><span class="s1">6&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">118</span><span class="p">,</span><span class="mi">119</span><span class="p">),</span>
    <span class="sa">u</span><span class="s1">&#39;</span><span class="se">\u03b2</span><span class="s1">7&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">133</span><span class="p">,</span><span class="mi">135</span><span class="p">),</span>
    <span class="sa">u</span><span class="s1">&#39;</span><span class="se">\u03b2</span><span class="s1">8&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">140</span><span class="p">,</span><span class="mi">149</span><span class="p">),</span>
    <span class="sa">u</span><span class="s1">&#39;</span><span class="se">\u03b2</span><span class="s1">9&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">153</span><span class="p">,</span><span class="mi">162</span><span class="p">),</span>
    <span class="sa">u</span><span class="s1">&#39;</span><span class="se">\u03b2</span><span class="s1">10&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">167</span><span class="p">,</span><span class="mi">176</span><span class="p">),</span>
    <span class="sa">u</span><span class="s1">&#39;</span><span class="se">\u03b1</span><span class="s1">3&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">187</span><span class="p">,</span><span class="mi">201</span><span class="p">),</span>
    <span class="sa">u</span><span class="s1">&#39;</span><span class="se">\u03b2</span><span class="s1">11&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">211</span><span class="p">,</span><span class="mi">214</span><span class="p">),</span>
    <span class="sa">u</span><span class="s1">&#39;</span><span class="se">\u03b1</span><span class="s1">4&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">220</span><span class="p">,</span><span class="mi">239</span><span class="p">),</span>
    <span class="sa">u</span><span class="s1">&#39;</span><span class="se">\u03b1</span><span class="s1">5&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">245</span><span class="p">,</span><span class="mi">254</span><span class="p">),</span>
    <span class="sa">u</span><span class="s1">&#39;</span><span class="se">\u03b1</span><span class="s1">6&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">263</span><span class="p">,</span><span class="mi">279</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</section>
<section id="Main-text-figures">
<h1>Main text figures<a class="headerlink" href="#Main-text-figures" title="Link to this heading">ÔÉÅ</a></h1>
<section id="PCA-of-COLAV-representations">
<h2>PCA of COLAV representations<a class="headerlink" href="#PCA-of-COLAV-representations" title="Link to this heading">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># PC space plots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="c1"># ax = ax.flatten()</span>
<span class="n">pca_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">u_A</span><span class="p">,</span> <span class="n">pw_A</span><span class="p">,</span> <span class="n">sa_A</span><span class="p">]</span>
<span class="n">struc_list_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">dihedral_strucs</span><span class="p">,</span> <span class="n">pw_strucs</span><span class="p">,</span> <span class="n">sa_strucs</span><span class="p">]</span>
<span class="n">title_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Dihedral Angles&quot;</span><span class="p">,</span> <span class="s2">&quot;C</span><span class="se">\u03b1</span><span class="s2"> Pairwise Distances&quot;</span><span class="p">,</span> <span class="s2">&quot;Strain Analysis&quot;</span><span class="p">]</span>

<span class="c1"># enumerate the axes and the list of the PCAs</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="c1"># determine conformation color</span>
<span class="n">conformations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">struc_list_list</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
    <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;ptp1b_data/&quot;</span><span class="p">):</span>
        <span class="n">conformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conformation_dict</span><span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">8</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">conformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conformation_dict</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

<span class="n">conformations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">conformations</span><span class="p">)</span>

<span class="n">cluster1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_open&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_open&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;open/open&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">cluster2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_closed&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_closed&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;open/closed&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">cluster3</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_open&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_open&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;closed/open&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">cluster4</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_closed&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_closed&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;closed/closed&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">struc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dihedral_strucs</span><span class="p">):</span>
    <span class="k">if</span> <span class="s1">&#39;1nwl&#39;</span> <span class="ow">in</span> <span class="n">struc</span> <span class="ow">or</span> <span class="s1">&#39;4qbw&#39;</span> <span class="ow">in</span> <span class="n">struc</span> <span class="ow">or</span> <span class="s1">&#39;1pxh&#39;</span> <span class="ow">in</span> <span class="n">struc</span> <span class="ow">or</span> <span class="s1">&#39;1sug&#39;</span> <span class="ow">in</span> <span class="n">struc</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">u_A</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">u_A</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;PC2&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;PC1&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PTP-1B </span><span class="si">{</span><span class="n">title_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
<span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span>
<span class="n">handles</span><span class="o">=</span><span class="p">[</span><span class="n">cluster1</span><span class="p">,</span> <span class="n">cluster2</span><span class="p">,</span> <span class="n">cluster3</span><span class="p">,</span> <span class="n">cluster4</span><span class="p">],</span>
<span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;open/open&quot;</span><span class="p">,</span> <span class="s2">&quot;open/closed&quot;</span><span class="p">,</span> <span class="s2">&quot;closed/open&quot;</span><span class="p">,</span> <span class="s2">&quot;closed/closed&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/ptp1b_paper_results_and_figures_21_0.png" src="_images/ptp1b_paper_results_and_figures_21_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># PC space plots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">pca_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">pw_A</span><span class="p">,</span> <span class="n">sa_A</span><span class="p">]</span>
<span class="n">struc_list_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">pw_strucs</span><span class="p">,</span> <span class="n">sa_strucs</span><span class="p">]</span>
<span class="n">title_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;C</span><span class="se">\u03b1</span><span class="s2"> Pairwise Distances&quot;</span><span class="p">,</span> <span class="s2">&quot;Strain Analysis&quot;</span><span class="p">]</span>

<span class="c1"># enumerate the axes and the list of the PCAs</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pca_list</span><span class="p">)):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

    <span class="c1"># determine conformation color</span>
    <span class="n">conformations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">struc_list_list</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;ptp1b_data/&quot;</span><span class="p">):</span>
            <span class="n">conformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conformation_dict</span><span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">8</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">conformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conformation_dict</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

    <span class="n">conformations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">conformations</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">cluster1</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_open&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_open&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;open/open&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">cluster2</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_closed&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_closed&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;open/closed&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">cluster3</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_open&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_open&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;closed/open&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">cluster4</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_closed&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_closed&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;closed/closed&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;PC3&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;PC1&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PTP-1B </span><span class="si">{</span><span class="n">title_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cluster1</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_open&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_open&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;open/open&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">cluster2</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_closed&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_closed&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;open/closed&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">cluster3</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_open&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_open&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;closed/open&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">cluster4</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_closed&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_closed&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;closed/closed&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;PC2&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;PC1&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PTP-1B </span><span class="si">{</span><span class="n">title_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># ax[0].legend(</span>
<span class="c1">#     loc=&quot;upper left&quot;,</span>
<span class="c1">#     handles=[cluster1, cluster2, cluster3, cluster4],</span>
<span class="c1">#     labels=[&quot;open/open&quot;, &quot;open/closed&quot;, &quot;closed/open&quot;, &quot;closed/closed&quot;],</span>
<span class="c1"># )</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/ptp1b_paper_results_and_figures_22_0.png" src="_images/ptp1b_paper_results_and_figures_22_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create array for storing correlation coefficients</span>
<span class="n">dh_pw_matrix</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="n">dh_sa_matrix</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="n">pw_sa_matrix</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="n">psi_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">untreated_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">omg_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">untreated_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">phi_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">untreated_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="c1"># load the shared atom data</span>
<span class="n">shared_atom_set</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;ptp1b_data/ptp1b_atom_set.pkl&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="c1"># calculate the correlation coefficients</span>
        <span class="n">dh_pw_matrix</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">pearsonr</span><span class="p">(</span>
                <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">u_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])[</span><span class="n">psi_idx</span><span class="p">]</span>
                <span class="o">+</span> <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">u_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])[</span><span class="n">phi_idx</span><span class="p">]</span>
                <span class="o">+</span> <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">u_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])[</span><span class="n">omg_idx</span><span class="p">],</span>
                <span class="n">calculate_pw_rc</span><span class="p">(</span><span class="n">pw_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:],</span> <span class="n">resnum_bounds</span><span class="p">)[</span><span class="mi">1</span><span class="p">:],</span>
            <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">dh_sa_matrix</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">pearsonr</span><span class="p">(</span>
                <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">u_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])[</span><span class="n">psi_idx</span><span class="p">]</span>
                <span class="o">+</span> <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">u_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])[</span><span class="n">phi_idx</span><span class="p">]</span>
                <span class="o">+</span> <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">u_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])[</span><span class="n">omg_idx</span><span class="p">],</span>
                <span class="n">calculate_sa_rc</span><span class="p">(</span><span class="n">sa_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:],</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">shared_atom_set</span><span class="p">))[</span><span class="mi">1</span><span class="p">:],</span>
            <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">pw_sa_matrix</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">pearsonr</span><span class="p">(</span>
                <span class="n">calculate_pw_rc</span><span class="p">(</span><span class="n">pw_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">resnum_bounds</span><span class="p">),</span>
                <span class="n">calculate_sa_rc</span><span class="p">(</span><span class="n">sa_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:],</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">shared_atom_set</span><span class="p">)),</span>
            <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">)</span>

<span class="n">dh_pw_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dh_pw_matrix</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">dh_sa_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dh_sa_matrix</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">pw_sa_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pw_sa_matrix</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u_pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([0.29747788, 0.06309758, 0.037037  , 0.03535305, 0.0287802 ,
       0.02453796, 0.02153294, 0.01868356, 0.01458321, 0.01343809])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">axs_list</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;Dihedral Angles&quot;</span><span class="p">,</span> <span class="s2">&quot;C</span><span class="se">\u03b1</span><span class="s2"> Pairwise Distances&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;Dihedral Angles&quot;</span><span class="p">,</span> <span class="s2">&quot;Strain Analysis&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;C</span><span class="se">\u03b1</span><span class="s2"> Pairwise</span><span class="se">\n</span><span class="s2">Distances&quot;</span><span class="p">,</span> <span class="s2">&quot;Strain Analysis&quot;</span><span class="p">)]</span>
<span class="n">dot_matrix_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">dh_pw_matrix</span><span class="p">,</span> <span class="n">dh_sa_matrix</span><span class="p">,</span> <span class="n">pw_sa_matrix</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">dot_matrix_list</span><span class="p">[</span><span class="n">i</span><span class="p">][:</span><span class="mi">3</span><span class="p">,:</span><span class="mi">3</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;cividis&quot;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">axs_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> RCs&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">axs_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> RCs&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RC Comparison of </span><span class="si">{</span><span class="n">axs_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">and </span><span class="si">{</span><span class="n">axs_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">axs_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Dihedral Angles&quot;</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;RC Comparison of </span><span class="si">{</span><span class="n">axs_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">axs_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">pw_pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s1">%)&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">sa_pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s1">%)&#39;</span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">u_pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s1">%)&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">pw_pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s1">%)&#39;</span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)])</span>
    <span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">cax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="s2">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="s2">&quot;3%&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/ptp1b_paper_results_and_figures_25_0.png" src="_images/ptp1b_paper_results_and_figures_25_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">dh_tl</span> <span class="o">=</span> <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">u_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])[</span><span class="n">psi_idx</span><span class="p">]</span> <span class="o">+</span> <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">u_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])[</span><span class="n">phi_idx</span><span class="p">]</span> <span class="o">+</span> <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">u_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])[</span><span class="n">omg_idx</span><span class="p">]</span>
    <span class="n">pw_tl</span> <span class="o">=</span> <span class="n">calculate_pw_rc</span><span class="p">(</span><span class="n">pw_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">resnum_bounds</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">sa_tl</span> <span class="o">=</span> <span class="n">calculate_sa_rc</span><span class="p">(</span><span class="n">sa_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">shared_atom_set</span><span class="p">))[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="c1">#         [pearsonr(dh_tl, dh_tl)[0], pearsonr(dh_tl, pw_tl)[0], pearsonr(dh_tl, sa_tl)[0]],</span>
<span class="c1">#         [pearsonr(pw_tl, dh_tl)[0], pearsonr(pw_tl, pw_tl)[0], pearsonr(pw_tl, sa_tl)[0]],</span>
<span class="c1">#         [pearsonr(sa_tl, dh_tl)[0], pearsonr(sa_tl, pw_tl)[0], pearsonr(sa_tl, sa_tl)[0]],</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">pearsonr</span><span class="p">(</span><span class="n">dh_tl</span><span class="p">,</span> <span class="n">pw_tl</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pearsonr</span><span class="p">(</span><span class="n">dh_tl</span><span class="p">,</span> <span class="n">sa_tl</span><span class="p">)[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">pearsonr</span><span class="p">(</span><span class="n">pw_tl</span><span class="p">,</span> <span class="n">dh_tl</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pearsonr</span><span class="p">(</span><span class="n">pw_tl</span><span class="p">,</span> <span class="n">sa_tl</span><span class="p">)[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">pearsonr</span><span class="p">(</span><span class="n">sa_tl</span><span class="p">,</span> <span class="n">dh_tl</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pearsonr</span><span class="p">(</span><span class="n">sa_tl</span><span class="p">,</span> <span class="n">pw_tl</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">]),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;cividis&quot;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="c1">#     ax[i].set_xlabel(f&quot;Representation&quot;)</span>
<span class="c1">#     ax[i].set_ylabel(f&quot;Representation&quot;)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RC</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> Comparison&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s1">&#39;Dihedral</span><span class="se">\n</span><span class="s1">Angles&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;C</span><span class="se">\u03b1</span><span class="s1"> Pairwise</span><span class="se">\n</span><span class="s1">Distances&#39;</span><span class="p">,</span> <span class="s1">&#39;Strain</span><span class="se">\n</span><span class="s1">Analysis&#39;</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s1">&#39;Dihedral</span><span class="se">\n</span><span class="s1">Angles&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;C</span><span class="se">\u03b1</span><span class="s1"> Pairwise</span><span class="se">\n</span><span class="s1">Distances&#39;</span><span class="p">,</span> <span class="s1">&#39;Strain</span><span class="se">\n</span><span class="s1">Analysis&#39;</span><span class="p">])</span>
    <span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">cax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="s2">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="s2">&quot;3%&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/ptp1b_paper_results_and_figures_26_0.png" src="_images/ptp1b_paper_results_and_figures_26_0.png" />
</div>
</div>
</section>
<section id="Dihedral-Angle-PCA-space-(PC1-&amp;-PC2)-with-RC1-&amp;-RC2">
<h2>Dihedral Angle PCA space (PC1 &amp; PC2) with RC1 &amp; RC2<a class="headerlink" href="#Dihedral-Angle-PCA-space-(PC1-&-PC2)-with-RC1-&-RC2" title="Link to this heading">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gs_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axd</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot_mosaic</span><span class="p">(</span>
    <span class="p">[[</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;upper right&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;lower right&quot;</span><span class="p">]],</span>
    <span class="n">gridspec_kw</span><span class="o">=</span><span class="n">gs_kw</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
    <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">,</span>
    <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axd</span><span class="p">):</span>
    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># determine conformation color</span>
        <span class="n">conformations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dihedral_strucs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;ptp1b_data/&quot;</span><span class="p">):</span>
                <span class="n">conformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conformation_dict</span><span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">8</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">conformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conformation_dict</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

        <span class="n">conformations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">conformations</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">u_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_open&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">u_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_open&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;open/open&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">u_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_closed&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">u_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_closed&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;open/closed&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">u_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_open&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">u_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_open&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;closed/open&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">u_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_closed&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">u_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_closed&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;closed/closed&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="c1">#         axd[ax].scatter(</span>
<span class="c1">#             u_A[[33, 45, 59, 125], 0],</span>
<span class="c1">#             u_A[[33, 45, 59, 125], 1],</span>
<span class="c1">#             marker=&quot;x&quot;,</span>
<span class="c1">#             s=100,</span>
<span class="c1">#             c=&quot;k&quot;,</span>
<span class="c1">#             label=&quot;examples&quot;,</span>
<span class="c1">#         )</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;PC2&quot;</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;PC1&quot;</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;PTP-1B Dihedral Angles&quot;</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">psi_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">untreated_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">omg_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">untreated_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">phi_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">untreated_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">dh_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">resnum_bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">resnum_bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="p">(</span><span class="n">phi_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">dh_range</span><span class="p">,</span>
            <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">u_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])[</span><span class="n">phi_idx</span><span class="p">],</span>
            <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\phi$&quot;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="p">(</span><span class="n">psi_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">dh_range</span><span class="p">,</span>
            <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">u_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])[</span><span class="n">psi_idx</span><span class="p">],</span>
            <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\psi$&quot;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="p">(</span><span class="n">omg_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">dh_range</span><span class="p">,</span>
            <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">u_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])[</span><span class="n">omg_idx</span><span class="p">],</span>
            <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\omega$&quot;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ylims</span> <span class="o">=</span> <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PTP-1B Dihedral Angles RC</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span>
            <span class="p">[</span><span class="n">dh</span> <span class="k">for</span> <span class="n">dh</span> <span class="ow">in</span> <span class="n">dh_range</span> <span class="k">if</span> <span class="n">dh</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">dh</span> <span class="k">if</span> <span class="n">dh</span> <span class="o">%</span> <span class="mi">50</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">dh</span> <span class="ow">in</span> <span class="n">dh_range</span> <span class="k">if</span> <span class="n">dh</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="c1">#         axd[ax].set_yticks(np.arange(0, axd[ax].get_yticks().max(), 0.1), labels=np.round(np.arange(0, axd[ax].get_yticks().max(), 0.1), 2))</span>

        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span>
            <span class="n">Rectangle</span><span class="p">(</span>
                <span class="p">(</span><span class="mi">176</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                <span class="n">height</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span>  <span class="c1"># WPD loop</span>
                <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;#785EF0&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span>
            <span class="n">Rectangle</span><span class="p">(</span>
                <span class="p">(</span><span class="mi">237</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                <span class="n">height</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span>  <span class="c1"># L16 loop</span>
                <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;#FFB000&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">280</span><span class="p">),</span> <span class="p">[</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">*</span><span class="mi">273</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">ylims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">1.1</span><span class="p">))</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">ptp1b_ss_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;</span><span class="se">\u03b1</span><span class="s1">&#39;</span><span class="p">):</span>
                <span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
                <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span> <span class="o">+</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">((</span><span class="n">ts</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">3.6</span><span class="p">),</span> <span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">30</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">ts</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">3.6</span><span class="p">)</span><span class="o">+</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="s1">&#39;upper right&#39;</span><span class="p">:</span>
                    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="mf">1.5</span><span class="o">*</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">30</span><span class="p">)</span> <span class="k">if</span> <span class="n">counter</span><span class="o">%</span><span class="k">2</span> == 0 else ylims[1]-(3*ylims[1]/30), k, fontsize=&#39;small&#39;, alpha=0.7)
                    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">17</span><span class="p">),</span> <span class="n">head_width</span><span class="o">=</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">12</span><span class="p">),</span> <span class="n">head_length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="s1">&#39;upper right&#39;</span><span class="p">:</span>
                    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="mf">1.5</span><span class="o">*</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">30</span><span class="p">)</span> <span class="k">if</span> <span class="n">counter</span><span class="o">%</span><span class="k">2</span> == 0 else ylims[1]-(3*ylims[1]/30), k, fontsize=&#39;small&#39;, alpha=0.7)
                    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Relative Value&quot;</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;upper right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;upper right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center left&quot;</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;lower right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Residue Number&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/ptp1b_paper_results_and_figures_28_0.png" src="_images/ptp1b_paper_results_and_figures_28_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l16_loop_dihedrals</span> <span class="o">=</span> <span class="n">untreated_dihedrals</span><span class="p">[:,</span><span class="mi">687</span><span class="p">:</span><span class="mi">714</span><span class="p">]</span>
<span class="n">l16_loop_dihedrals_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">l16_loop_dihedrals</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">l16_loop_dihedrals</span><span class="p">)])</span>
<span class="n">l16_loop_pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">l16_loop_A</span> <span class="o">=</span> <span class="n">l16_loop_pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">l16_loop_dihedrals_data</span><span class="p">)</span>
<span class="n">l16_loop_pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([0.63530741, 0.07368558, 0.06210699, 0.03719484, 0.03084564,
       0.02494609, 0.01972787, 0.0180215 , 0.01457365, 0.0123182 ])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[63]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gs_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axd</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot_mosaic</span><span class="p">(</span>
    <span class="p">[[</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;upper right&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;lower right&quot;</span><span class="p">]],</span>
    <span class="n">gridspec_kw</span><span class="o">=</span><span class="n">gs_kw</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
    <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">,</span>
    <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">tl_list</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axd</span><span class="p">):</span>
    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># determine conformation color</span>
        <span class="n">conformations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dihedral_strucs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;ptp1b_data/&quot;</span><span class="p">):</span>
                <span class="n">conformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conformation_dict</span><span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">8</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">conformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conformation_dict</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

        <span class="n">conformations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">conformations</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">l16_loop_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_open&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">l16_loop_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_open&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;open/open&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">l16_loop_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_closed&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">l16_loop_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_closed&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;open/closed&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">l16_loop_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_open&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">l16_loop_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_open&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;closed/open&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">l16_loop_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_closed&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">l16_loop_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_closed&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;closed/closed&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="c1">#         for j in np.arange(l16_loop_A.shape[0]):</span>
<span class="c1">#             if l16_loop_A[j,1] &gt; 0 and l16_loop_A[j,0] &gt; -0.5:</span>
<span class="c1">#                 axd[ax].annotate(dihedral_strucs[j].split(&#39;/&#39;)[-1][8:-4], (l16_loop_A[j,0], l16_loop_A[j,1]))</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;PC2&quot;</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;PC1&quot;</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;PTP-1B (L16 loop) Dihedral Angles&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">l16_loop_A</span><span class="p">[</span><span class="n">conformations</span><span class="o">==</span><span class="s1">&#39;open_open&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                  <span class="n">l16_loop_A</span><span class="p">[</span><span class="n">conformations</span><span class="o">==</span><span class="s1">&#39;open_closed&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                  <span class="n">l16_loop_A</span><span class="p">[</span><span class="n">conformations</span><span class="o">==</span><span class="s1">&#39;closed_open&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                  <span class="n">l16_loop_A</span><span class="p">[</span><span class="n">conformations</span><span class="o">==</span><span class="s1">&#39;closed_closed&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">),</span>
        <span class="n">bins</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;open/open&#39;</span><span class="p">,</span> <span class="s1">&#39;open/closed&#39;</span><span class="p">,</span> <span class="s1">&#39;closed/open&#39;</span><span class="p">,</span> <span class="s1">&#39;closed/closed&#39;</span><span class="p">])</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;PTP-1B (L16 loop) Dihedral Angles PC1&#39;</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;PC1&#39;</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Counts&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">psi_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">l16_loop_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">omg_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">l16_loop_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">phi_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">l16_loop_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">dh_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">236</span><span class="p">,</span> <span class="mi">244</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">(</span><span class="n">phi_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">dh_range</span><span class="p">,</span>
            <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">l16_loop_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">tl_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]])[</span><span class="n">phi_idx</span><span class="p">],</span>
            <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\phi$&quot;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="p">(</span><span class="n">psi_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">dh_range</span><span class="p">,</span>
            <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">l16_loop_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">tl_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]])[</span><span class="n">psi_idx</span><span class="p">],</span>
            <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\psi$&quot;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="p">(</span><span class="n">omg_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">dh_range</span><span class="p">,</span>
            <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">l16_loop_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">tl_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]])[</span><span class="n">omg_idx</span><span class="p">],</span>
            <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\omega$&quot;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ylims</span> <span class="o">=</span> <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;PTP-1B (L16 loop) Dihedral Angles RC</span><span class="si">{</span><span class="n">tl_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span>
            <span class="p">[</span><span class="n">dh</span> <span class="k">for</span> <span class="n">dh</span> <span class="ow">in</span> <span class="n">dh_range</span><span class="p">],</span>
            <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">dh</span> <span class="k">for</span> <span class="n">dh</span> <span class="ow">in</span> <span class="n">dh_range</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Relative Value&quot;</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Residue Number&quot;</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;upper right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;lower right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/ptp1b_paper_results_and_figures_30_0.png" src="_images/ptp1b_paper_results_and_figures_30_0.png" />
</div>
</div>
</section>
<section id="Contingency-table-and-chi-squared-test">
<h2>Contingency table and chi-squared test<a class="headerlink" href="#Contingency-table-and-chi-squared-test" title="Link to this heading">ÔÉÅ</a></h2>
<p>The null hypothesis of this hypothesis test is that the three regions of PTP-1B ‚Äì WPD loop, L16 loop, and <span class="math">\alpha7</span> helix ‚Äì are</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a7_helix</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dihedral_strucs</span><span class="p">):</span>
    <span class="n">a7_helix</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PandasPdb</span><span class="p">()</span><span class="o">.</span><span class="n">read_pdb</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ATOM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">residue_number</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">a7_helix</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">a7_helix</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">290</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">closed_wpd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dihedral_strucs</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>
<span class="n">closed_l16</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dihedral_strucs</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">conf</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">conformations</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">conf</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;closed&quot;</span><span class="p">):</span>
        <span class="n">closed_wpd</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">conf</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;closed&quot;</span><span class="p">):</span>
        <span class="n">closed_l16</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ctable</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_open&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a7_helix</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_closed&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a7_helix</span><span class="p">))],</span>
           <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_open&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a7_helix</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_closed&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a7_helix</span><span class="p">))]],</span>
          <span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_open&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">a7_helix</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_closed&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">a7_helix</span><span class="p">))],</span>
           <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_open&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">a7_helix</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_closed&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">a7_helix</span><span class="p">))]]])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ctable</span><span class="p">[</span><span class="mi">0</span><span class="p">,:,:],</span> <span class="n">ctable</span><span class="p">[</span><span class="mi">1</span><span class="p">,:,:]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([[221,   4],
        [ 23,   1]]),
 array([[ 7,  5],
        [16, 72]]))
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test1</span> <span class="o">=</span> <span class="n">chi2_contingency</span><span class="p">(</span><span class="n">ctable</span><span class="p">[</span><span class="mi">0</span><span class="p">,:,:])</span>
<span class="n">test2</span> <span class="o">=</span> <span class="n">chi2_contingency</span><span class="p">(</span><span class="n">ctable</span><span class="p">[</span><span class="mi">1</span><span class="p">,:,:])</span>
<span class="n">test1</span><span class="o">.</span><span class="n">statistic</span> <span class="o">+</span> <span class="n">test2</span><span class="o">.</span><span class="n">statistic</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
7.480061435105047
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test1</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Chi2ContingencyResult(statistic=0.0007653688524590214, pvalue=0.9779290992834958, dof=1, expected_freq=array([[220.48192771,   4.51807229],
       [ 23.51807229,   0.48192771]]))
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test2</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Chi2ContingencyResult(statistic=7.479296066252588, pvalue=0.006241246758944259, dof=1, expected_freq=array([[ 2.76,  9.24],
       [20.24, 67.76]]))
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test1</span><span class="o">.</span><span class="n">pvalue</span><span class="p">,</span> <span class="n">test2</span><span class="o">.</span><span class="n">pvalue</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(0.9779290992834958, 0.006241246758944259)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">chi2_contingency</span><span class="p">(</span><span class="n">ctable</span><span class="p">)</span>
<span class="n">result</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Chi2ContingencyResult(statistic=738.115835766452, pvalue=1.942909006865765e-158, dof=4, expected_freq=array([[[129.36241082,  39.72927973],
        [ 61.13329119,  18.77501827]],

       [[ 51.95277543,  15.95553403],
        [ 24.55152257,   7.54016798]]]))
</pre></div></div>
</div>
</section>
<section id="Oxidized-conformation-of-PTP-1B">
<h2>Oxidized conformation of PTP-1B<a class="headerlink" href="#Oxidized-conformation-of-PTP-1B" title="Link to this heading">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[67]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gs_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axd</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot_mosaic</span><span class="p">(</span>
    <span class="p">[[</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;upper right&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;lower right&quot;</span><span class="p">]],</span>
    <span class="n">gridspec_kw</span><span class="o">=</span><span class="n">gs_kw</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
    <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">,</span>
    <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">tl_list</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axd</span><span class="p">):</span>
    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># determine conformation color</span>
        <span class="n">conformations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dihedral_strucs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;ptp1b_data/&quot;</span><span class="p">):</span>
                <span class="n">conformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conformation_dict</span><span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">8</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">conformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conformation_dict</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

        <span class="n">conformations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">conformations</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">u_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_open&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
            <span class="n">u_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_open&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;open/open&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">u_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_closed&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
            <span class="n">u_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_closed&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;open/closed&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">u_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_open&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
            <span class="n">u_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_open&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;closed/open&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">u_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_closed&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
            <span class="n">u_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_closed&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;closed/closed&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;PC5&quot;</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;PC4&quot;</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;PTP-1B Dihedral Angles&quot;</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">)</span>

        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">u_A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">u_A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">u_A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;PTP1B-y&#39;</span> <span class="ow">in</span> <span class="n">dihedral_strucs</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">dihedral_strucs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">14</span><span class="p">:</span><span class="o">-</span><span class="mi">11</span><span class="p">],</span>
                                     <span class="p">(</span><span class="n">u_A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">u_A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span>
                                     <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">u_A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="mf">0.6</span> <span class="k">if</span> <span class="n">counter</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">u_A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">u_A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span>
                                     <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;small&#39;</span>
                                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">dihedral_strucs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">8</span><span class="p">:</span><span class="o">-</span><span class="mi">11</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span>
                                     <span class="p">(</span><span class="n">u_A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">u_A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span>
                                     <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">u_A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="mf">0.6</span> <span class="k">if</span> <span class="n">counter</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">u_A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">u_A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span>
                                     <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;small&#39;</span>
                                    <span class="p">)</span>
                <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">psi_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">untreated_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">omg_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">untreated_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">phi_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">untreated_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">dh_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">resnum_bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">resnum_bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="p">(</span><span class="n">phi_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">dh_range</span><span class="p">,</span>
            <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">u_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">tl_list</span><span class="p">[</span><span class="n">i</span><span class="p">]])[</span><span class="n">phi_idx</span><span class="p">],</span>
            <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\phi$&quot;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="p">(</span><span class="n">psi_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">dh_range</span><span class="p">,</span>
            <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">u_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">tl_list</span><span class="p">[</span><span class="n">i</span><span class="p">]])[</span><span class="n">psi_idx</span><span class="p">],</span>
            <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\psi$&quot;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="p">(</span><span class="n">omg_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">dh_range</span><span class="p">,</span>
            <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">u_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">tl_list</span><span class="p">[</span><span class="n">i</span><span class="p">]])[</span><span class="n">omg_idx</span><span class="p">],</span>
            <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\omega$&quot;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ylims</span> <span class="o">=</span> <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PTP-1B Dihedral Angles RC</span><span class="si">{</span><span class="n">tl_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span>
            <span class="p">[</span><span class="n">dh</span> <span class="k">for</span> <span class="n">dh</span> <span class="ow">in</span> <span class="n">dh_range</span> <span class="k">if</span> <span class="n">dh</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">dh</span> <span class="k">if</span> <span class="n">dh</span> <span class="o">%</span> <span class="mi">50</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">dh</span> <span class="ow">in</span> <span class="n">dh_range</span> <span class="k">if</span> <span class="n">dh</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">)</span>

        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span>
            <span class="n">Rectangle</span><span class="p">(</span>
                <span class="p">(</span><span class="mi">213</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
                <span class="n">height</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span>  <span class="c1"># P loop</span>
                <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;#ff7f0e&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span>
            <span class="n">Rectangle</span><span class="p">(</span>
                <span class="p">(</span><span class="mi">44</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                <span class="n">height</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span>  <span class="c1"># pY loop</span>
                <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;#ff7f0e&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span>
            <span class="n">Rectangle</span><span class="p">(</span>
                <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                <span class="n">height</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span>  <span class="c1"># Y loop</span>
                <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;#03c03c&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span>
            <span class="n">Rectangle</span><span class="p">(</span>
                <span class="p">(</span><span class="mi">257</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                <span class="n">height</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span>  <span class="c1"># Q loop</span>
                <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;#ff7f0e&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">280</span><span class="p">),</span> <span class="p">[</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">*</span><span class="mi">273</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">ylims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">1.1</span><span class="p">))</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">ptp1b_ss_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;</span><span class="se">\u03b1</span><span class="s1">&#39;</span><span class="p">):</span>
                <span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
                <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span> <span class="o">+</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">((</span><span class="n">ts</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">3.6</span><span class="p">),</span> <span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">30</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">ts</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">3.6</span><span class="p">)</span><span class="o">+</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="s1">&#39;upper right&#39;</span><span class="p">:</span>
                    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="mf">1.5</span><span class="o">*</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">30</span><span class="p">)</span> <span class="k">if</span> <span class="n">counter</span><span class="o">%</span><span class="k">2</span> == 0 else ylims[1]-(3*ylims[1]/30), k, fontsize=&#39;small&#39;, alpha=0.7)
                    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">17</span><span class="p">),</span> <span class="n">head_width</span><span class="o">=</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">12</span><span class="p">),</span> <span class="n">head_length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="s1">&#39;upper right&#39;</span><span class="p">:</span>
                    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="mf">1.5</span><span class="o">*</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">30</span><span class="p">)</span> <span class="k">if</span> <span class="n">counter</span><span class="o">%</span><span class="k">2</span> == 0 else ylims[1]-(3*ylims[1]/30), k, fontsize=&#39;small&#39;, alpha=0.7)
                    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Relative Value&quot;</span><span class="p">)</span>
<span class="c1"># PDB structures all show the oxidized conformation with sulphenyl-amide ring</span>
<span class="c1"># frag screen structures show BME adduct-like conformation</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;upper right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;upper right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center left&quot;</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;lower right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Residue Number&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/ptp1b_paper_results_and_figures_42_0.png" src="_images/ptp1b_paper_results_and_figures_42_0.png" />
</div>
</div>
</section>
<section id="PCA-on-PDB-structures-only">
<h2>PCA on PDB structures only<a class="headerlink" href="#PCA-on-PDB-structures-only" title="Link to this heading">ÔÉÅ</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pdb_strucs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="n">pdb_dihedrals_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dihedral_strucs</span><span class="p">):</span>
    <span class="k">if</span> <span class="s2">&quot;PTP1B-y&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
        <span class="n">pdb_strucs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="n">pdb_dihedrals_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">untreated_dihedrals_data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span>
<span class="n">pdb_dihedrals_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pdb_dihedrals_data</span><span class="p">)</span>

<span class="n">pdb_pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">pdb_A</span> <span class="o">=</span> <span class="n">pdb_pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">pdb_dihedrals_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gs_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axd</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot_mosaic</span><span class="p">(</span>
    <span class="p">[[</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;upper right&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;lower right&quot;</span><span class="p">]],</span>
    <span class="n">gridspec_kw</span><span class="o">=</span><span class="n">gs_kw</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
    <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">,</span>
    <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">tl_list</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axd</span><span class="p">):</span>
    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># determine conformation color</span>
        <span class="n">conformations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">pdb_strucs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;ptp1b_data/&quot;</span><span class="p">):</span>
                <span class="n">conformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conformation_dict</span><span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">8</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">conformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conformation_dict</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

        <span class="n">conformations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">conformations</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">pdb_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_open&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">pdb_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_open&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;open/open&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">pdb_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_closed&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">pdb_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_closed&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;open/closed&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">pdb_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_open&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">pdb_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_open&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;closed/open&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">pdb_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_closed&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">pdb_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_closed&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;closed/closed&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;PC2&quot;</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;PC1&quot;</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;PTP-1B (PDB) Dihedral Angles&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">psi_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pdb_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">omg_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pdb_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">phi_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">pdb_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">dh_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">resnum_bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">resnum_bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="p">(</span><span class="n">phi_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">dh_range</span><span class="p">,</span>
            <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">pdb_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">tl_list</span><span class="p">[</span><span class="n">i</span><span class="p">]])[</span><span class="n">phi_idx</span><span class="p">],</span>
            <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\phi$&quot;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="p">(</span><span class="n">psi_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">dh_range</span><span class="p">,</span>
            <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">pdb_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">tl_list</span><span class="p">[</span><span class="n">i</span><span class="p">]])[</span><span class="n">psi_idx</span><span class="p">],</span>
            <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\psi$&quot;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="p">(</span><span class="n">omg_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">dh_range</span><span class="p">,</span>
            <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">pdb_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">tl_list</span><span class="p">[</span><span class="n">i</span><span class="p">]])[</span><span class="n">omg_idx</span><span class="p">],</span>
            <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\omega$&quot;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ylims</span> <span class="o">=</span> <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;PTP-1B (PDB) Dihedral Angles RC</span><span class="si">{</span><span class="n">tl_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span>
            <span class="p">[</span><span class="n">dh</span> <span class="k">for</span> <span class="n">dh</span> <span class="ow">in</span> <span class="n">dh_range</span> <span class="k">if</span> <span class="n">dh</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">dh</span> <span class="k">if</span> <span class="n">dh</span> <span class="o">%</span> <span class="mi">50</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">dh</span> <span class="ow">in</span> <span class="n">dh_range</span> <span class="k">if</span> <span class="n">dh</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">)</span>

        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span>
            <span class="n">Rectangle</span><span class="p">(</span>
                <span class="p">(</span><span class="mi">176</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                <span class="n">height</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span>  <span class="c1"># WPD loop</span>
                <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;#785EF0&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span>
            <span class="n">Rectangle</span><span class="p">(</span>
                <span class="p">(</span><span class="mi">237</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                <span class="n">height</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span>  <span class="c1"># L16 loop</span>
                <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;#FFB000&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">280</span><span class="p">),</span> <span class="p">[</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">*</span><span class="mi">273</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">ylims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">1.1</span><span class="p">))</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">ptp1b_ss_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;</span><span class="se">\u03b1</span><span class="s1">&#39;</span><span class="p">):</span>
                <span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
                <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span> <span class="o">+</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">((</span><span class="n">ts</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">3.6</span><span class="p">),</span> <span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">30</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">ts</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">3.6</span><span class="p">)</span><span class="o">+</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="s1">&#39;upper right&#39;</span><span class="p">:</span>
                    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="mf">1.5</span><span class="o">*</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">30</span><span class="p">)</span> <span class="k">if</span> <span class="n">counter</span><span class="o">%</span><span class="k">2</span> == 0 else ylims[1]-(3*ylims[1]/30), k, fontsize=&#39;small&#39;, alpha=0.7)
                    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">17</span><span class="p">),</span> <span class="n">head_width</span><span class="o">=</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">12</span><span class="p">),</span> <span class="n">head_length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="s1">&#39;upper right&#39;</span><span class="p">:</span>
                    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="mf">1.5</span><span class="o">*</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">30</span><span class="p">)</span> <span class="k">if</span> <span class="n">counter</span><span class="o">%</span><span class="k">2</span> == 0 else ylims[1]-(3*ylims[1]/30), k, fontsize=&#39;small&#39;, alpha=0.7)
                    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Relative Value&quot;</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;upper right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;upper right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center left&quot;</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;lower right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Residue Number&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/ptp1b_paper_results_and_figures_45_0.png" src="_images/ptp1b_paper_results_and_figures_45_0.png" />
</div>
</div>
</section>
<section id="PCA-on-crystallographic-drug-fragment-screen-structures">
<h2>PCA on crystallographic drug fragment screen structures<a class="headerlink" href="#PCA-on-crystallographic-drug-fragment-screen-structures" title="Link to this heading">ÔÉÅ</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fragment_strucs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="n">fragment_dihedrals_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dihedral_strucs</span><span class="p">):</span>
    <span class="k">if</span> <span class="s2">&quot;PTP1B-y&quot;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
        <span class="n">fragment_strucs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="n">fragment_dihedrals_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">untreated_dihedrals_data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span>
<span class="n">fragment_dihedrals_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fragment_dihedrals_data</span><span class="p">)</span>

<span class="n">fragment_pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">fragment_A</span> <span class="o">=</span> <span class="n">fragment_pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">fragment_dihedrals_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[65]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gs_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axd</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot_mosaic</span><span class="p">(</span>
    <span class="p">[[</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;upper right&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;lower right&quot;</span><span class="p">]],</span>
    <span class="n">gridspec_kw</span><span class="o">=</span><span class="n">gs_kw</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
    <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">,</span>
    <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">tl_list</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axd</span><span class="p">):</span>
    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># determine conformation color</span>
        <span class="n">conformations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">fragment_strucs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;ptp1b_data/&quot;</span><span class="p">):</span>
                <span class="n">conformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conformation_dict</span><span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">8</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">conformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conformation_dict</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

        <span class="n">conformations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">conformations</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">fragment_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_open&quot;</span><span class="p">,</span> <span class="n">tl_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
            <span class="n">fragment_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_open&quot;</span><span class="p">,</span> <span class="n">tl_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;open/open&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">fragment_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_closed&quot;</span><span class="p">,</span> <span class="n">tl_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
            <span class="n">fragment_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_closed&quot;</span><span class="p">,</span> <span class="n">tl_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;open/closed&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">fragment_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_open&quot;</span><span class="p">,</span> <span class="n">tl_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
            <span class="n">fragment_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_open&quot;</span><span class="p">,</span> <span class="n">tl_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;closed/open&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">fragment_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_closed&quot;</span><span class="p">,</span> <span class="n">tl_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
            <span class="n">fragment_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_closed&quot;</span><span class="p">,</span> <span class="n">tl_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;closed/closed&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PC</span><span class="si">{</span><span class="n">tl_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PC</span><span class="si">{</span><span class="n">tl_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;PTP-1B (Fragment) Dihedral Angles&quot;</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">psi_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fragment_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">omg_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">fragment_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">phi_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">fragment_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">dh_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">resnum_bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">resnum_bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="p">(</span><span class="n">phi_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">dh_range</span><span class="p">,</span>
            <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">fragment_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">tl_list</span><span class="p">[</span><span class="n">i</span><span class="p">]])[</span><span class="n">phi_idx</span><span class="p">],</span>
            <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\phi$&quot;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="p">(</span><span class="n">psi_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">dh_range</span><span class="p">,</span>
            <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">fragment_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">tl_list</span><span class="p">[</span><span class="n">i</span><span class="p">]])[</span><span class="n">psi_idx</span><span class="p">],</span>
            <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\psi$&quot;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="p">(</span><span class="n">omg_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">dh_range</span><span class="p">,</span>
            <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">fragment_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">tl_list</span><span class="p">[</span><span class="n">i</span><span class="p">]])[</span><span class="n">omg_idx</span><span class="p">],</span>
            <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\omega$&quot;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ylims</span> <span class="o">=</span> <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;PTP-1B (Fragment) Dihedral Angles RC</span><span class="si">{</span><span class="n">tl_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span>
            <span class="p">[</span><span class="n">dh</span> <span class="k">for</span> <span class="n">dh</span> <span class="ow">in</span> <span class="n">dh_range</span> <span class="k">if</span> <span class="n">dh</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">dh</span> <span class="k">if</span> <span class="n">dh</span> <span class="o">%</span> <span class="mi">50</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">dh</span> <span class="ow">in</span> <span class="n">dh_range</span> <span class="k">if</span> <span class="n">dh</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">)</span>

        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span>
            <span class="n">Rectangle</span><span class="p">(</span>
                <span class="p">(</span><span class="mi">176</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                <span class="n">height</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span>  <span class="c1"># WPD loop</span>
                <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;#785EF0&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span>
            <span class="n">Rectangle</span><span class="p">(</span>
                <span class="p">(</span><span class="mi">237</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                <span class="n">height</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span>  <span class="c1"># L16 loop</span>
                <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;#FFB000&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">280</span><span class="p">),</span> <span class="p">[</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">*</span><span class="mi">273</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">ylims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">1.1</span><span class="p">))</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">ptp1b_ss_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;</span><span class="se">\u03b1</span><span class="s1">&#39;</span><span class="p">):</span>
                <span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
                <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span> <span class="o">+</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">((</span><span class="n">ts</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">3.6</span><span class="p">),</span> <span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">30</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">ts</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">3.6</span><span class="p">)</span><span class="o">+</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="s1">&#39;upper right&#39;</span><span class="p">:</span>
                    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="mf">1.5</span><span class="o">*</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">30</span><span class="p">)</span> <span class="k">if</span> <span class="n">counter</span><span class="o">%</span><span class="k">2</span> == 0 else ylims[1]-(3*ylims[1]/30), k, fontsize=&#39;small&#39;, alpha=0.7)
                    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">17</span><span class="p">),</span> <span class="n">head_width</span><span class="o">=</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">12</span><span class="p">),</span> <span class="n">head_length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="s1">&#39;upper right&#39;</span><span class="p">:</span>
                    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="mf">1.5</span><span class="o">*</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">30</span><span class="p">)</span> <span class="k">if</span> <span class="n">counter</span><span class="o">%</span><span class="k">2</span> == 0 else ylims[1]-(3*ylims[1]/30), k, fontsize=&#39;small&#39;, alpha=0.7)
                    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Relative Value&quot;</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;upper right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;upper right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center left&quot;</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;lower right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Residue Number&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/ptp1b_paper_results_and_figures_48_0.png" src="_images/ptp1b_paper_results_and_figures_48_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[66]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gs_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axd</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot_mosaic</span><span class="p">(</span>
    <span class="p">[[</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;upper right&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;lower right&quot;</span><span class="p">]],</span>
    <span class="n">gridspec_kw</span><span class="o">=</span><span class="n">gs_kw</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
    <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">,</span>
    <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">tl_list</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axd</span><span class="p">):</span>
    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># determine conformation color</span>
        <span class="n">conformations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">fragment_strucs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;ptp1b_data/&quot;</span><span class="p">):</span>
                <span class="n">conformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conformation_dict</span><span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">8</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">conformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conformation_dict</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

        <span class="n">conformations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">conformations</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">fragment_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_open&quot;</span><span class="p">,</span> <span class="n">tl_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
            <span class="n">fragment_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_open&quot;</span><span class="p">,</span> <span class="n">tl_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;open/open&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">fragment_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_closed&quot;</span><span class="p">,</span> <span class="n">tl_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
            <span class="n">fragment_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_closed&quot;</span><span class="p">,</span> <span class="n">tl_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;open/closed&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">fragment_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_open&quot;</span><span class="p">,</span> <span class="n">tl_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
            <span class="n">fragment_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_open&quot;</span><span class="p">,</span> <span class="n">tl_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;closed/open&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">fragment_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_closed&quot;</span><span class="p">,</span> <span class="n">tl_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
            <span class="n">fragment_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_closed&quot;</span><span class="p">,</span> <span class="n">tl_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;closed/closed&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PC</span><span class="si">{</span><span class="n">tl_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PC</span><span class="si">{</span><span class="n">tl_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;PTP-1B (Fragment) Dihedral Angles&quot;</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">psi_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fragment_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">omg_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">fragment_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">phi_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">fragment_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">dh_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">resnum_bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">resnum_bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="p">(</span><span class="n">phi_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">dh_range</span><span class="p">,</span>
            <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">fragment_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">tl_list</span><span class="p">[</span><span class="n">i</span><span class="p">]])[</span><span class="n">phi_idx</span><span class="p">],</span>
            <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\phi$&quot;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="p">(</span><span class="n">psi_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">dh_range</span><span class="p">,</span>
            <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">fragment_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">tl_list</span><span class="p">[</span><span class="n">i</span><span class="p">]])[</span><span class="n">psi_idx</span><span class="p">],</span>
            <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\psi$&quot;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="p">(</span><span class="n">omg_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">dh_range</span><span class="p">,</span>
            <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">fragment_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">tl_list</span><span class="p">[</span><span class="n">i</span><span class="p">]])[</span><span class="n">omg_idx</span><span class="p">],</span>
            <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\omega$&quot;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ylims</span> <span class="o">=</span> <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;PTP-1B (Fragment) Dihedral Angles RC</span><span class="si">{</span><span class="n">tl_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span>
            <span class="p">[</span><span class="n">dh</span> <span class="k">for</span> <span class="n">dh</span> <span class="ow">in</span> <span class="n">dh_range</span> <span class="k">if</span> <span class="n">dh</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">dh</span> <span class="k">if</span> <span class="n">dh</span> <span class="o">%</span> <span class="mi">50</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">dh</span> <span class="ow">in</span> <span class="n">dh_range</span> <span class="k">if</span> <span class="n">dh</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">)</span>

        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span>
            <span class="n">Rectangle</span><span class="p">(</span>
                <span class="p">(</span><span class="mi">213</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
                <span class="n">height</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span>  <span class="c1"># P loop</span>
                <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;#ff7f0e&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span>
            <span class="n">Rectangle</span><span class="p">(</span>
                <span class="p">(</span><span class="mi">44</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                <span class="n">height</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span>  <span class="c1"># pY loop</span>
                <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;#ff7f0e&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span>
            <span class="n">Rectangle</span><span class="p">(</span>
                <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                <span class="n">height</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span>  <span class="c1"># Y loop</span>
                <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;slateblue&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span>
            <span class="n">Rectangle</span><span class="p">(</span>
                <span class="p">(</span><span class="mi">257</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                <span class="n">height</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span>  <span class="c1"># Q loop</span>
                <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;#ff7f0e&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">280</span><span class="p">),</span> <span class="p">[</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">*</span><span class="mi">273</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">ylims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">1.1</span><span class="p">))</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">ptp1b_ss_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;</span><span class="se">\u03b1</span><span class="s1">&#39;</span><span class="p">):</span>
                <span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
                <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span> <span class="o">+</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">((</span><span class="n">ts</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">3.6</span><span class="p">),</span> <span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">30</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">ts</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">3.6</span><span class="p">)</span><span class="o">+</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">#                 if ax == &#39;upper right&#39;:</span>
<span class="c1">#                     axd[ax].text(v[0], ylims[1]+(1.5*ylims[1]/30) if counter%2 == 0 else ylims[1]-(3*ylims[1]/30), k, fontsize=&#39;small&#39;, alpha=0.7)</span>
<span class="c1">#                     counter += 1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">17</span><span class="p">),</span> <span class="n">head_width</span><span class="o">=</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">12</span><span class="p">),</span> <span class="n">head_length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="c1">#                 if ax == &#39;upper right&#39;:</span>
<span class="c1">#                     axd[ax].text(v[0], ylims[1]+(1.5*ylims[1]/30) if counter%2 == 0 else ylims[1]-(3*ylims[1]/30), k, fontsize=&#39;small&#39;, alpha=0.7)</span>
<span class="c1">#                     counter += 1</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Relative Value&quot;</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;upper right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;upper right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center left&quot;</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;lower right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Residue Number&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/ptp1b_paper_results_and_figures_49_0.png" src="_images/ptp1b_paper_results_and_figures_49_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gs_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axd</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot_mosaic</span><span class="p">(</span>
    <span class="p">[[</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;upper right&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;lower right&quot;</span><span class="p">]],</span>
    <span class="n">gridspec_kw</span><span class="o">=</span><span class="n">gs_kw</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
    <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">,</span>
    <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">tl_list</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axd</span><span class="p">):</span>
    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># determine conformation color</span>
        <span class="n">conformations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">fragment_strucs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;ptp1b_data/&quot;</span><span class="p">):</span>
                <span class="n">conformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conformation_dict</span><span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">8</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">conformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conformation_dict</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

        <span class="n">conformations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">conformations</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">fragment_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_open&quot;</span><span class="p">,</span> <span class="n">tl_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
            <span class="n">fragment_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_open&quot;</span><span class="p">,</span> <span class="n">tl_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;open/open&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">fragment_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_closed&quot;</span><span class="p">,</span> <span class="n">tl_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
            <span class="n">fragment_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_closed&quot;</span><span class="p">,</span> <span class="n">tl_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;open/closed&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">fragment_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_open&quot;</span><span class="p">,</span> <span class="n">tl_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
            <span class="n">fragment_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_open&quot;</span><span class="p">,</span> <span class="n">tl_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;closed/open&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">fragment_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_closed&quot;</span><span class="p">,</span> <span class="n">tl_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
            <span class="n">fragment_A</span><span class="p">[</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_closed&quot;</span><span class="p">,</span> <span class="n">tl_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;closed/closed&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PC</span><span class="si">{</span><span class="n">tl_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PC</span><span class="si">{</span><span class="n">tl_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;PTP-1B (Fragment) Dihedral Angles PCA&quot;</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">psi_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fragment_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">omg_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">fragment_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">phi_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">fragment_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">dh_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">resnum_bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">resnum_bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="p">(</span><span class="n">phi_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">dh_range</span><span class="p">,</span>
            <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">fragment_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">tl_list</span><span class="p">[</span><span class="n">i</span><span class="p">]])[</span><span class="n">phi_idx</span><span class="p">],</span>
            <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\phi$&quot;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="p">(</span><span class="n">psi_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">dh_range</span><span class="p">,</span>
            <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">fragment_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">tl_list</span><span class="p">[</span><span class="n">i</span><span class="p">]])[</span><span class="n">psi_idx</span><span class="p">],</span>
            <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\psi$&quot;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="p">(</span><span class="n">omg_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">dh_range</span><span class="p">,</span>
            <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">fragment_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">tl_list</span><span class="p">[</span><span class="n">i</span><span class="p">]])[</span><span class="n">omg_idx</span><span class="p">],</span>
            <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\omega$&quot;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ylims</span> <span class="o">=</span> <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;PTP-1B (Fragment) Dihedral Angles RC</span><span class="si">{</span><span class="n">tl_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span>
            <span class="p">[</span><span class="n">dh</span> <span class="k">for</span> <span class="n">dh</span> <span class="ow">in</span> <span class="n">dh_range</span> <span class="k">if</span> <span class="n">dh</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">dh</span> <span class="k">if</span> <span class="n">dh</span> <span class="o">%</span> <span class="mi">50</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">dh</span> <span class="ow">in</span> <span class="n">dh_range</span> <span class="k">if</span> <span class="n">dh</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">)</span>

        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span>
            <span class="n">Rectangle</span><span class="p">(</span>
                <span class="p">(</span><span class="mi">176</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                <span class="n">height</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span>  <span class="c1"># WPD loop</span>
                <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;#785EF0&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span>
            <span class="n">Rectangle</span><span class="p">(</span>
                <span class="p">(</span><span class="mi">237</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                <span class="n">height</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span>  <span class="c1"># L16 loop</span>
                <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;#FFB000&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span>
            <span class="n">Rectangle</span><span class="p">(</span>
                <span class="p">(</span><span class="mi">213</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
                <span class="n">height</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span>  <span class="c1"># P loop</span>
                <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;#ff7f0e&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span>
            <span class="n">Rectangle</span><span class="p">(</span>
                <span class="p">(</span><span class="mi">44</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                <span class="n">height</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span>  <span class="c1"># pY loop</span>
                <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;#ff7f0e&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span>
            <span class="n">Rectangle</span><span class="p">(</span>
                <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                <span class="n">height</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span>  <span class="c1"># Y loop</span>
                <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;slateblue&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span>
            <span class="n">Rectangle</span><span class="p">(</span>
                <span class="p">(</span><span class="mi">257</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                <span class="n">height</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span>  <span class="c1"># Q loop</span>
                <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;#ff7f0e&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">280</span><span class="p">),</span> <span class="p">[</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">*</span><span class="mi">273</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">ylims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">1.1</span><span class="p">))</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">ptp1b_ss_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;</span><span class="se">\u03b1</span><span class="s1">&#39;</span><span class="p">):</span>
                <span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
                <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span> <span class="o">+</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">((</span><span class="n">ts</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">3.6</span><span class="p">),</span> <span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">30</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">ts</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">3.6</span><span class="p">)</span><span class="o">+</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="s1">&#39;upper right&#39;</span><span class="p">:</span>
                    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="mf">1.5</span><span class="o">*</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">30</span><span class="p">)</span> <span class="k">if</span> <span class="n">counter</span><span class="o">%</span><span class="k">2</span> == 0 else ylims[1]-(3*ylims[1]/30), k, fontsize=&#39;small&#39;, alpha=0.7)
                    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">17</span><span class="p">),</span> <span class="n">head_width</span><span class="o">=</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">12</span><span class="p">),</span> <span class="n">head_length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="s1">&#39;upper right&#39;</span><span class="p">:</span>
                    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="mf">1.5</span><span class="o">*</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">30</span><span class="p">)</span> <span class="k">if</span> <span class="n">counter</span><span class="o">%</span><span class="k">2</span> == 0 else ylims[1]-(3*ylims[1]/30), k, fontsize=&#39;small&#39;, alpha=0.7)
                    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Relative Value&quot;</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;upper right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;upper right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center left&quot;</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;lower right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Residue Number&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/ptp1b_paper_results_and_figures_50_0.png" src="_images/ptp1b_paper_results_and_figures_50_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">dot_matrix_all</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="n">dot_matrix_pdb</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">dot_matrix_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">pearsonr</span><span class="p">(</span>
                <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">u_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])[</span><span class="n">psi_idx</span><span class="p">]</span>
                <span class="o">+</span> <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">u_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])[</span><span class="n">phi_idx</span><span class="p">]</span>
                <span class="o">+</span> <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">u_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])[</span><span class="n">omg_idx</span><span class="p">],</span>
                <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">fragment_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:])[</span><span class="n">psi_idx</span><span class="p">]</span>
                <span class="o">+</span> <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">fragment_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:])[</span><span class="n">phi_idx</span><span class="p">]</span>
                <span class="o">+</span> <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">fragment_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:])[</span><span class="n">omg_idx</span><span class="p">]</span>
            <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">dot_matrix_pdb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">pearsonr</span><span class="p">(</span>
                <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">pdb_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])[</span><span class="n">psi_idx</span><span class="p">]</span>
                <span class="o">+</span> <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">pdb_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])[</span><span class="n">phi_idx</span><span class="p">]</span>
                <span class="o">+</span> <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">pdb_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])[</span><span class="n">omg_idx</span><span class="p">],</span>
                <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">fragment_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:])[</span><span class="n">psi_idx</span><span class="p">]</span>
                <span class="o">+</span> <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">fragment_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:])[</span><span class="n">phi_idx</span><span class="p">]</span>
                <span class="o">+</span> <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">fragment_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:])[</span><span class="n">omg_idx</span><span class="p">],</span>
            <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">)</span>

<span class="n">dot_matrix_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dot_matrix_all</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">dot_matrix_pdb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dot_matrix_pdb</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">dot_matrix_all</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">dot_matrix_pdb</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;cividis&quot;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">cax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="s2">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="s2">&quot;3%&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">labels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">labels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Fragment RCs&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;All RCs&quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;PDB RCs&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;PTP-1B RC Comparison of All</span><span class="se">\n</span><span class="s2"> and Fragment Datasets&quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;PTP-1B RC Comparison of PDB</span><span class="se">\n</span><span class="s2"> and Fragment Datasets&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/ptp1b_paper_results_and_figures_51_0.png" src="_images/ptp1b_paper_results_and_figures_51_0.png" />
</div>
</div>
</section>
<section id="COV-and-MAT-score-calculations">
<h2>COV and MAT score calculations<a class="headerlink" href="#COV-and-MAT-score-calculations" title="Link to this heading">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate_coverage_matching_scores(pdb_strucs, fragment_strucs, (7,279), rmsd_threshold=1.0, verbose=True)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Coverage metric: 96.3%
Matching metric: 0.493
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(0.9629629629629629, 0.49268775667528564)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">pdb_strucs</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">fragment_strucs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(162, 187)
</pre></div></div>
</div>
</section>
<section id="Conformational-changes-focusing-on-individual-PCs">
<h2>Conformational changes focusing on individual PCs<a class="headerlink" href="#Conformational-changes-focusing-on-individual-PCs" title="Link to this heading">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># allosteric steering</span>
<span class="n">gs_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axd</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot_mosaic</span><span class="p">(</span>
    <span class="p">[[</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;upper right&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;lower right&quot;</span><span class="p">]],</span>
    <span class="n">gridspec_kw</span><span class="o">=</span><span class="n">gs_kw</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
    <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">,</span>
    <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">pc1_idxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">u_A</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">pc2_idxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">u_A</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">idx_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">pc1_idxs</span><span class="p">,</span> <span class="n">pc2_idxs</span><span class="p">]</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axd</span><span class="p">):</span>
    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">c_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;open_open&quot;</span><span class="p">:</span> <span class="s2">&quot;#1f77b4&quot;</span><span class="p">,</span>
            <span class="s2">&quot;open_closed&quot;</span><span class="p">:</span> <span class="s2">&quot;#ff7f0e&quot;</span><span class="p">,</span>
            <span class="s2">&quot;closed_open&quot;</span><span class="p">:</span> <span class="s2">&quot;#2ca02c&quot;</span><span class="p">,</span>
            <span class="s2">&quot;closed_closed&quot;</span><span class="p">:</span> <span class="s2">&quot;#d62728&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">conformations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dihedral_strucs</span><span class="p">)[</span><span class="n">idx_list</span><span class="p">[</span><span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]]:</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;ptp1b_data/ptp1b_theseus_data/&quot;</span><span class="p">):</span>
                <span class="n">conformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c_dict</span><span class="p">[</span><span class="n">conformation_dict</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">8</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]]])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">conformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c_dict</span><span class="p">[</span><span class="n">conformation_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
        <span class="n">conformations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">conformations</span><span class="p">)</span>

        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">u_A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
            <span class="n">u_A</span><span class="p">[</span><span class="n">idx_list</span><span class="p">[</span><span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">c</span><span class="o">=</span><span class="n">conformations</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">236.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
            <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">190</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Open</span><span class="se">\n</span><span class="s1">WPD loop&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
            <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Closed</span><span class="se">\n</span><span class="s1">WPD loop&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">58.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
            <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Closed</span><span class="se">\n</span><span class="s1">L16 loop&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
            <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">70</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Open</span><span class="se">\n</span><span class="s1">L16 loop&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PC</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2"> z-score&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PTP-1B Structures Ordered by PC</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">axd</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">left</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">u_A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">axd</span><span class="p">[</span><span class="s2">&quot;upper right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
            <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span>
            <span class="n">handles</span><span class="o">=</span><span class="p">[</span><span class="n">cluster1</span><span class="p">,</span> <span class="n">cluster2</span><span class="p">,</span> <span class="n">cluster3</span><span class="p">,</span> <span class="n">cluster4</span><span class="p">],</span>
            <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;open/open&quot;</span><span class="p">,</span> <span class="s2">&quot;open/closed&quot;</span><span class="p">,</span> <span class="s2">&quot;closed/open&quot;</span><span class="p">,</span> <span class="s2">&quot;closed/closed&quot;</span><span class="p">],</span>
        <span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;upper right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;lower right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Structures&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/ptp1b_paper_results_and_figures_56_0.png" src="_images/ptp1b_paper_results_and_figures_56_0.png" />
</div>
</div>
</section>
</section>
<section id="Supplementary-Figures">
<h1>Supplementary Figures<a class="headerlink" href="#Supplementary-Figures" title="Link to this heading">ÔÉÅ</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># PC space plots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">pca_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">u_A</span><span class="p">,</span> <span class="n">rope_A</span><span class="p">,</span> <span class="n">pw_A</span><span class="p">]</span>
<span class="n">struc_list_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">dihedral_strucs</span><span class="p">,</span> <span class="n">rope_strucs</span><span class="p">,</span> <span class="n">pw_strucs</span><span class="p">]</span>
<span class="n">title_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Dihedral Angles&quot;</span><span class="p">,</span> <span class="s2">&quot;RoPE Dihedral Angles&quot;</span><span class="p">,</span> <span class="s2">&quot;C</span><span class="se">\u03b1</span><span class="s2"> Pairwise Distances&quot;</span><span class="p">]</span>

<span class="c1"># enumerate the axes and the list of the PCAs</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="c1"># determine conformation color</span>
    <span class="n">conformations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">struc_list_list</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;ptp1b_data/&quot;</span><span class="p">):</span>
            <span class="n">conformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conformation_dict</span><span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">8</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">conformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conformation_dict</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

    <span class="n">conformations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">conformations</span><span class="p">)</span>
    <span class="n">cluster1</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_open&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_open&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;open/open&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">cluster2</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_closed&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_closed&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;open/closed&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">cluster3</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_open&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_open&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;closed/open&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">cluster4</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_closed&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">pca_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_closed&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;closed/closed&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;PC2&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;PC1&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;PTP-1B &quot;</span> <span class="o">+</span> <span class="n">title_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
    <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span>
    <span class="n">handles</span><span class="o">=</span><span class="p">[</span><span class="n">cluster1</span><span class="p">,</span> <span class="n">cluster2</span><span class="p">,</span> <span class="n">cluster3</span><span class="p">,</span> <span class="n">cluster4</span><span class="p">],</span>
    <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;open/open&quot;</span><span class="p">,</span> <span class="s2">&quot;open/closed&quot;</span><span class="p">,</span> <span class="s2">&quot;closed/open&quot;</span><span class="p">,</span> <span class="s2">&quot;closed/closed&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/ptp1b_paper_results_and_figures_58_0.png" src="_images/ptp1b_paper_results_and_figures_58_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="c1"># ax = ax.flatten()</span>
<span class="n">dot_matrix_rope</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">dot_matrix_rope</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">pearsonr</span><span class="p">(</span>
                <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">u_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])[</span><span class="n">psi_idx</span><span class="p">]</span>
                <span class="o">+</span> <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">u_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])[</span><span class="n">phi_idx</span><span class="p">]</span>
                <span class="o">+</span> <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">u_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])[</span><span class="n">omg_idx</span><span class="p">],</span>
                <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">rope_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:])[</span><span class="n">psi_idx</span><span class="p">]</span>
                <span class="o">+</span> <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">rope_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:])[</span><span class="n">phi_idx</span><span class="p">]</span>
                <span class="o">+</span> <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">rope_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:])[</span><span class="n">omg_idx</span><span class="p">],</span>
            <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">)</span>

<span class="n">dot_matrix_rope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dot_matrix_rope</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">dot_matrix_rope</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;cividis&quot;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">cax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="s2">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="s2">&quot;3%&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">labels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">labels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;RoPE RCs&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Untreated RCs&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;PTP-1B RC Comparison of</span><span class="se">\n</span><span class="s2">Untreated and RoPE Structures&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/ptp1b_paper_results_and_figures_59_0.png" src="_images/ptp1b_paper_results_and_figures_59_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># determine the space groups of each of the structures</span>
<span class="n">sgs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">struc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dihedral_strucs</span><span class="p">):</span>
    <span class="n">sgs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">space_group_dict</span><span class="p">[</span><span class="n">struc</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">sgs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sgs</span><span class="p">)</span>

<span class="c1"># PC plot by space group</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>  <span class="c1"># ; ax = ax.flatten()</span>
<span class="c1"># for k in np.arange(1):</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">sgs</span><span class="p">)):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">u_A</span><span class="p">[</span><span class="n">sgs</span> <span class="o">==</span> <span class="n">sg</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">u_A</span><span class="p">[</span><span class="n">sgs</span> <span class="o">==</span> <span class="n">sg</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sg</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="p">(</span><span class="n">sgs</span><span class="o">==</span><span class="w"> </span><span class="n">sg</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;PC1&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;PC2&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;PTP-1B Dihedral Angles by Space Group&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/ptp1b_paper_results_and_figures_60_0.png" src="_images/ptp1b_paper_results_and_figures_60_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conf_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="n">sg_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dihedral_strucs</span><span class="p">):</span>

    <span class="n">sg_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">space_group_dict</span><span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]])</span>
    <span class="n">conf_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conformation_dict</span><span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">8</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]])</span>
<span class="n">sg_unq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">sg_list</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">conf_unq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">conf_list</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ctable</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dihedral_strucs</span><span class="p">)):</span>

    <span class="n">ctable</span><span class="p">[</span><span class="n">conf_unq</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">sg_unq</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">ctable</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[  0.,   4.,   2.,  67.,   0.,   0.],
       [  5.,   3.,  24.,   4.,   1.,   2.],
       [  0.,   1.,   1.,   7.,   0.,   0.],
       [  4.,   1.,   2., 215.,   6.,   0.]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chi2_contingency</span><span class="p">(</span><span class="n">ctable</span><span class="p">)</span><span class="o">.</span><span class="n">pvalue</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2.3184328298516617e-40
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[72]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate t-SNE and UMAP</span>
<span class="n">random_state</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">u_tsne</span> <span class="o">=</span> <span class="n">TSNE</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="s1">&#39;random&#39;</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">u_umap</span> <span class="o">=</span> <span class="n">UMAP</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="s1">&#39;random&#39;</span><span class="p">)</span>
<span class="n">u_tsne_transform</span> <span class="o">=</span> <span class="n">u_tsne</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">untreated_dihedrals_data</span><span class="p">)</span>
<span class="n">u_umap_transform</span> <span class="o">=</span> <span class="n">u_umap</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">untreated_dihedrals_data</span><span class="p">)</span>

<span class="n">pw_tsne</span> <span class="o">=</span> <span class="n">TSNE</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="s1">&#39;random&#39;</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">pw_umap</span> <span class="o">=</span> <span class="n">UMAP</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="s1">&#39;random&#39;</span><span class="p">)</span>
<span class="n">pw_tsne_transform</span> <span class="o">=</span> <span class="n">pw_tsne</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">pw_data</span><span class="p">)</span>
<span class="n">pw_umap_transform</span> <span class="o">=</span> <span class="n">pw_umap</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">pw_data</span><span class="p">)</span>

<span class="n">sa_tsne</span> <span class="o">=</span> <span class="n">TSNE</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="s1">&#39;random&#39;</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">sa_umap</span> <span class="o">=</span> <span class="n">UMAP</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="s1">&#39;random&#39;</span><span class="p">)</span>
<span class="n">sa_tsne_transform</span> <span class="o">=</span> <span class="n">sa_tsne</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">sa_data</span><span class="p">)</span>
<span class="n">sa_umap_transform</span> <span class="o">=</span> <span class="n">sa_umap</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">sa_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[73]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">transform_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">u_A</span><span class="p">,</span>
    <span class="n">u_tsne_transform</span><span class="p">,</span>
    <span class="n">u_umap_transform</span><span class="p">,</span>
    <span class="n">pw_A</span><span class="p">,</span>
    <span class="n">pw_tsne_transform</span><span class="p">,</span>
    <span class="n">pw_umap_transform</span><span class="p">,</span>
    <span class="n">sa_A</span><span class="p">,</span>
    <span class="n">sa_tsne_transform</span><span class="p">,</span>
    <span class="n">sa_umap_transform</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">struc_list_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">dihedral_strucs</span><span class="p">,</span>
    <span class="n">dihedral_strucs</span><span class="p">,</span>
    <span class="n">dihedral_strucs</span><span class="p">,</span>
    <span class="n">pw_strucs</span><span class="p">,</span>
    <span class="n">pw_strucs</span><span class="p">,</span>
    <span class="n">pw_strucs</span><span class="p">,</span>
    <span class="n">sa_strucs</span><span class="p">,</span>
    <span class="n">sa_strucs</span><span class="p">,</span>
    <span class="n">sa_strucs</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">title_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Dihedral Angles PCA&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Dihedral Angles t-SNE&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Dihedral Angles UMAP&quot;</span><span class="p">,</span>
    <span class="s2">&quot;C</span><span class="se">\u03b1</span><span class="s2"> Pairwise Distances PCA&quot;</span><span class="p">,</span>
    <span class="s2">&quot;C</span><span class="se">\u03b1</span><span class="s2"> Pairwise Distances t-SNE&quot;</span><span class="p">,</span>
    <span class="s2">&quot;C</span><span class="se">\u03b1</span><span class="s2"> Pairwise Distances UMAP&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Strain Analysis PCA&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Strain Analysis t-SNE&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Strain Analysis UMAP&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">transform_list</span><span class="p">)):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="c1"># determine conformation color</span>
    <span class="n">conformations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">struc_list_list</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;ptp1b_data/&quot;</span><span class="p">):</span>
            <span class="n">conformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conformation_dict</span><span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">8</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">conformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conformation_dict</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

    <span class="n">conformations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">conformations</span><span class="p">)</span>
    <span class="n">cluster1</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">transform_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_open&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">transform_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_open&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">3</span> <span class="k">else</span> <span class="n">transform_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_open&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;open/open&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">cluster2</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">transform_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_closed&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">transform_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_closed&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">3</span> <span class="k">else</span> <span class="n">transform_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;open_closed&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;open/closed&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">cluster3</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">transform_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_open&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">transform_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_open&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">3</span> <span class="k">else</span> <span class="n">transform_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_open&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;closed/open&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">cluster4</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">transform_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_closed&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">transform_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_closed&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">3</span> <span class="k">else</span> <span class="n">transform_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">conformations</span> <span class="o">==</span> <span class="s2">&quot;closed_closed&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;closed/closed&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Coordinate 2&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Coordinate 1&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;PTP-1B &quot;</span> <span class="o">+</span> <span class="n">title_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
    <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span>
    <span class="n">handles</span><span class="o">=</span><span class="p">[</span><span class="n">cluster1</span><span class="p">,</span> <span class="n">cluster2</span><span class="p">,</span> <span class="n">cluster3</span><span class="p">,</span> <span class="n">cluster4</span><span class="p">],</span>
    <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;open/open&quot;</span><span class="p">,</span> <span class="s2">&quot;open/closed&quot;</span><span class="p">,</span> <span class="s2">&quot;closed/open&quot;</span><span class="p">,</span> <span class="s2">&quot;closed/closed&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/ptp1b_paper_results_and_figures_64_0.png" src="_images/ptp1b_paper_results_and_figures_64_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">axs_list</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;Dihedral Angles&quot;</span><span class="p">,</span> <span class="s2">&quot;C</span><span class="se">\u03b1</span><span class="s2"> Pairwise Distances&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;Dihedral Angles&quot;</span><span class="p">,</span> <span class="s2">&quot;Strain Analysis&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;C</span><span class="se">\u03b1</span><span class="s2"> Pairwise Distances&quot;</span><span class="p">,</span> <span class="s2">&quot;Strain Analysis&quot;</span><span class="p">)]</span>
<span class="n">dot_matrix_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">dh_pw_matrix</span><span class="p">,</span> <span class="n">dh_sa_matrix</span><span class="p">,</span> <span class="n">pw_sa_matrix</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">dot_matrix_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;cividis&quot;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">axs_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> RCs&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">axs_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> RCs&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RC Comparison of </span><span class="si">{</span><span class="n">axs_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">and </span><span class="si">{</span><span class="n">axs_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">labels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">labels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">))</span>
    <span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">cax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="s2">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="s2">&quot;3%&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/ptp1b_paper_results_and_figures_65_0.png" src="_images/ptp1b_paper_results_and_figures_65_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dh_sa_matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dh_sa_matrix</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(0.7930733134139794, 0.7402361991988899)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># dihedral angle transformed loadings</span>
<span class="n">r</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">r_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">r</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">psi_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">untreated_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">omg_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">untreated_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">phi_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">untreated_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">dh_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">resnum_bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">resnum_bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="p">(</span><span class="n">phi_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">dh_range</span><span class="p">,</span>
            <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">u_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span><span class="o">//</span><span class="mi">2</span><span class="p">])[</span><span class="n">phi_idx</span><span class="p">],</span>
            <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\phi$&quot;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="p">(</span><span class="n">psi_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">dh_range</span><span class="p">,</span>
            <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">u_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span><span class="o">//</span><span class="mi">2</span><span class="p">])[</span><span class="n">psi_idx</span><span class="p">],</span>
            <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\psi$&quot;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="p">(</span><span class="n">omg_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">dh_range</span><span class="p">,</span>
            <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">u_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span><span class="o">//</span><span class="mi">2</span><span class="p">])[</span><span class="n">omg_idx</span><span class="p">],</span>
            <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\omega$&quot;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ylims</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PTP-1B Dihedral Angles RC</span><span class="si">{</span><span class="n">i</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span>
            <span class="p">[</span><span class="n">dh</span> <span class="k">for</span> <span class="n">dh</span> <span class="ow">in</span> <span class="n">dh_range</span> <span class="k">if</span> <span class="n">dh</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">dh</span> <span class="k">if</span> <span class="n">dh</span> <span class="o">%</span> <span class="mi">50</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">dh</span> <span class="ow">in</span> <span class="n">dh_range</span> <span class="k">if</span> <span class="n">dh</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Relative Value&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">r_list</span><span class="p">:</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">280</span><span class="p">),</span> <span class="p">[</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">*</span><span class="mi">273</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">ylims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">1.1</span><span class="p">))</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">ptp1b_ss_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;</span><span class="se">\u03b1</span><span class="s1">&#39;</span><span class="p">):</span>
                <span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span> <span class="o">+</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">((</span><span class="n">ts</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">3.6</span><span class="p">),</span> <span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">30</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">ts</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">3.6</span><span class="p">)</span><span class="o">+</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="mf">1.5</span><span class="o">*</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">30</span><span class="p">)</span> <span class="k">if</span> <span class="n">counter</span><span class="o">%</span><span class="k">2</span> == 0 else ylims[1]-(3*ylims[1]/30), k, fontsize=&#39;small&#39;, alpha=0.7)
                    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">17</span><span class="p">),</span> <span class="n">head_width</span><span class="o">=</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">12</span><span class="p">),</span> <span class="n">head_length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="mf">1.5</span><span class="o">*</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">30</span><span class="p">)</span> <span class="k">if</span> <span class="n">counter</span><span class="o">%</span><span class="k">2</span> == 0 else ylims[1]-(3*ylims[1]/30), k, fontsize=&#39;small&#39;, alpha=0.7)
                    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="p">(</span><span class="n">phi_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">dh_range</span><span class="p">,</span>
            <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">fragment_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span><span class="o">//</span><span class="mi">2</span><span class="p">])[</span><span class="n">phi_idx</span><span class="p">],</span>
            <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\phi$&quot;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="p">(</span><span class="n">psi_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">dh_range</span><span class="p">,</span>
            <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">fragment_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span><span class="o">//</span><span class="mi">2</span><span class="p">])[</span><span class="n">psi_idx</span><span class="p">],</span>
            <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\psi$&quot;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="p">(</span><span class="n">omg_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">dh_range</span><span class="p">,</span>
            <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">fragment_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span><span class="o">//</span><span class="mi">2</span><span class="p">])[</span><span class="n">omg_idx</span><span class="p">],</span>
            <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\omega$&quot;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ylims</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fragment PTP-1B Dihedral Angles RC</span><span class="si">{</span><span class="n">i</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span>
            <span class="p">[</span><span class="n">dh</span> <span class="k">for</span> <span class="n">dh</span> <span class="ow">in</span> <span class="n">dh_range</span> <span class="k">if</span> <span class="n">dh</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">dh</span> <span class="k">if</span> <span class="n">dh</span> <span class="o">%</span> <span class="mi">50</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">dh</span> <span class="ow">in</span> <span class="n">dh_range</span> <span class="k">if</span> <span class="n">dh</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Relative Value&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">r_list</span><span class="p">:</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">280</span><span class="p">),</span> <span class="p">[</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">*</span><span class="mi">273</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">ylims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">1.1</span><span class="p">))</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">ptp1b_ss_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;</span><span class="se">\u03b1</span><span class="s1">&#39;</span><span class="p">):</span>
                <span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span> <span class="o">+</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">((</span><span class="n">ts</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">3.6</span><span class="p">),</span> <span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">30</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">ts</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">3.6</span><span class="p">)</span><span class="o">+</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">0.14</span> <span class="k">if</span> <span class="n">counter</span><span class="o">%</span><span class="k">2</span> == 0 else ylims[1]+0.03, k, fontsize=&#39;small&#39;)
                    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">17</span><span class="p">),</span> <span class="n">head_width</span><span class="o">=</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">12</span><span class="p">),</span> <span class="n">head_length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">0.14</span> <span class="k">if</span> <span class="n">counter</span><span class="o">%</span><span class="k">2</span> == 0 else ylims[1]+0.03, k, fontsize=&#39;small&#39;)
                    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center left&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Residue Number&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Residue Number&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/ptp1b_paper_results_and_figures_67_0.png" src="_images/ptp1b_paper_results_and_figures_67_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># dihedral angle transformed loadings</span>
<span class="n">r</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">r_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">r</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">psi_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">untreated_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">omg_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">untreated_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">phi_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">untreated_dihedrals_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">dh_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">resnum_bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">resnum_bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
    <span class="p">(</span><span class="n">phi_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">dh_range</span><span class="p">,</span>
        <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">u_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">k</span><span class="p">])[</span><span class="n">phi_idx</span><span class="p">],</span>
        <span class="s2">&quot;-&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\phi$&quot;</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="p">(</span><span class="n">psi_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">dh_range</span><span class="p">,</span>
        <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">u_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">k</span><span class="p">])[</span><span class="n">psi_idx</span><span class="p">],</span>
        <span class="s2">&quot;-&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\psi$&quot;</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="p">(</span><span class="n">omg_trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">dh_range</span><span class="p">,</span>
        <span class="n">calculate_dh_rc</span><span class="p">(</span><span class="n">u_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">k</span><span class="p">])[</span><span class="n">omg_idx</span><span class="p">],</span>
        <span class="s2">&quot;-&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\omega$&quot;</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PTP-1B Dihedral Angles Residue Contribution </span><span class="si">{</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> (RC</span><span class="si">{</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span>
        <span class="p">[</span><span class="n">dh</span> <span class="k">for</span> <span class="n">dh</span> <span class="ow">in</span> <span class="n">dh_range</span> <span class="k">if</span> <span class="n">dh</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">dh</span> <span class="k">if</span> <span class="n">dh</span> <span class="o">%</span> <span class="mi">50</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">dh</span> <span class="ow">in</span> <span class="n">dh_range</span> <span class="k">if</span> <span class="n">dh</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mf">0.1</span><span class="p">),</span>
        <span class="n">labels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mf">0.1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Relative Value&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">r_list</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Residue Number&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Residue Number&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/ptp1b_paper_results_and_figures_68_0.png" src="_images/ptp1b_paper_results_and_figures_68_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conformations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">pw_strucs</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;ptp1b_data/&quot;</span><span class="p">):</span>
        <span class="n">conformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conformation_dict</span><span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">8</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">conformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conformation_dict</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
<span class="n">conformations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">conformations</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pw_strucs</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">pw_A</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pw_strucs</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">pw_A</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])])</span>
<span class="n">pc_num</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">pw_A</span><span class="p">[</span><span class="n">conformations</span><span class="o">==</span><span class="s1">&#39;open_open&#39;</span><span class="p">,</span><span class="n">pc_num</span><span class="p">],</span>
          <span class="n">pw_A</span><span class="p">[</span><span class="n">conformations</span><span class="o">==</span><span class="s1">&#39;open_closed&#39;</span><span class="p">,</span><span class="n">pc_num</span><span class="p">],</span>
          <span class="n">pw_A</span><span class="p">[</span><span class="n">conformations</span><span class="o">==</span><span class="s1">&#39;closed_open&#39;</span><span class="p">,</span><span class="n">pc_num</span><span class="p">],</span>
          <span class="n">pw_A</span><span class="p">[</span><span class="n">conformations</span><span class="o">==</span><span class="s1">&#39;closed_closed&#39;</span><span class="p">,</span><span class="n">pc_num</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">),</span>
<span class="n">bins</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;open/open&#39;</span><span class="p">,</span> <span class="s1">&#39;open/closed&#39;</span><span class="p">,</span> <span class="s1">&#39;closed/open&#39;</span><span class="p">,</span> <span class="s1">&#39;closed/closed&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;PTP-1B Pairwise Distances PC</span><span class="si">{</span><span class="n">pc_num</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;PC</span><span class="si">{</span><span class="n">pc_num</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Counts&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ptp1b_data/ptp1b_theseus_data/theseus_6bai_chainA.pdb
ptp1b_data/ptp1b_theseus_data/theseus_1g1h_chainA.pdb
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;Counts&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/ptp1b_paper_results_and_figures_69_2.png" src="_images/ptp1b_paper_results_and_figures_69_2.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pairwise distances tranformed loadings</span>
<span class="n">r</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">r_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">r</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">resnum_bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">resnum_bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">calculate_pw_rc</span><span class="p">(</span><span class="n">pw_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">resnum_bounds</span><span class="p">),</span>
        <span class="s2">&quot;-&quot;</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PTP-1B C</span><span class="se">\u03b1</span><span class="s2"> Pairwise Distances RC</span><span class="si">{</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span>
        <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">resnum_bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">resnum_bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">labels</span><span class="o">=</span><span class="p">[</span>
            <span class="n">x</span> <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">50</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">resnum_bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">resnum_bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="p">],</span>
    <span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Relative Value&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">r_list</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
<span class="n">ax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Residue Number&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Residue Number&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/ptp1b_paper_results_and_figures_70_0.png" src="_images/ptp1b_paper_results_and_figures_70_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># strain analysis tranformed loadings</span>
<span class="n">r</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">r_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">r</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">shared_atom_set</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;ptp1b_data/ptp1b_atom_set.pkl&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">))</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">resnum_bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">resnum_bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">calculate_sa_rc</span><span class="p">(</span><span class="n">sa_pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">shared_atom_set</span><span class="p">)),</span>
        <span class="s2">&quot;-&quot;</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PTP-1B Strain Analysis RC</span><span class="si">{</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span>
        <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">resnum_bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">resnum_bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">labels</span><span class="o">=</span><span class="p">[</span>
            <span class="n">x</span> <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">50</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">resnum_bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">resnum_bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="p">],</span>
    <span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Relative Value&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">r_list</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
<span class="n">ax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Residue Number&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Residue Number&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/ptp1b_paper_results_and_figures_71_0.png" src="_images/ptp1b_paper_results_and_figures_71_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="example.html" class="btn btn-neutral float-left" title="Example Usage" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Ammaar Saeed.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>